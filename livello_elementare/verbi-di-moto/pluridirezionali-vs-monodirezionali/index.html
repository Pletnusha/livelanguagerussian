<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PLURIDIREZIONALI VS MONODIREZIONALI - LIVE LANGUAGE_RUSSIAN</title>
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=League+Spartan:wght@700&family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
</head>
<body class="page-pluridirezionali-vs-monodirezionali">

    <header class="page-header">
        <a href="/livello_elementare/verbi-di-moto/index.html" class="back-link">‚Üê Torna indietro</a>
    </header>

    <section class="argomento-header">
        <h1 class="argomento-title">–•–û–î–ò–¢–¨ vs –ò–î–¢–ò</h1>
        <p class="argomento-focus"><!-- TODO: Focus --></p>
    </section>

    <section class="argomento-intro">
        <p><!-- TODO: Intro text --></p>
    </section>

    <main class="exercises-section">

        <!-- ============================================================ -->
        <!-- Panel 1 -->
        <!-- ============================================================ -->
        <article class="exercise-card" data-status="open" data-target="panel-acc-open-1">
            <span class="exercise-type">Drag &amp; Drop</span>
            <h3 class="exercise-title">–ö—É–¥–∞ —Ç—ã –∏–¥—ë—à—å? –ú—ã –æ–±—ã—á–Ω–æ —Ö–æ–¥–∏–º...</h3>
        </article>

        <div class="universal-dd" id="ex-dragdrop-plur-01" style="max-width: 800px; margin: 0 auto;">
    
    <div id="ex-dragdrop-plur-01-container">
        </div>

    <div id="ex-dragdrop-plur-01-completion" style="display: none; text-align: center; padding: 2rem;">
        </div>

</div>

<style>
    /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å —Ç–≤–æ–∏–º —Å–∫—Ä–∏–ø—Ç–æ–º */
    #ex-dragdrop-plur-01 .exercise-counter {
        font-size: 0.9rem; color: #888; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 1rem;
    }
    #ex-dragdrop-plur-01 .feedback {
        margin-top: 15px; font-weight: bold; min-height: 24px;
    }
    /* –¶–≤–µ—Ç–∞ –¥–ª—è –∫–Ω–æ–ø–æ–∫, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–≤–æ–π —Å–∫—Ä–∏–ø—Ç */
    #ex-dragdrop-plur-01 .btn-primary { background-color: #2a5bd7; color: #fff; }
    #ex-dragdrop-plur-01 .btn-secondary { background-color: #666; color: #fff; }
</style>

<script>
(() => {
    const root = document.getElementById('ex-dragdrop-plur-01');
    const exerciseContainer = root.querySelector('#ex-dragdrop-plur-01-container');
    const completionScreen = root.querySelector('#ex-dragdrop-plur-01-completion');

    const exercises = [
        {
            instruction: "Completa la frase scegliendo 2 verbi adatti al contesto",
            text: " –û–±—ã—á–Ω–æ –º—ã {{1}} –∑–∞–≤—Ç—Ä–∞–∫–∞—Ç—å –≤ –±–∞—Ä —Ä—è–¥–æ–º —Å –¥–æ–º–æ–º, –Ω–æ —Å–µ–≥–æ–¥–Ω—è –º—ã {{2}} –∑–∞–≤—Ç—Ä–∞–∫–∞—Ç—å –≤ —Ü–µ–Ω—Ç—Ä.",
            words: ["—Ö–æ—Ç–∏—Ç—å", "—Ö–æ–¥–∏–º", "–∏–¥—ë—Ç–µ", "–∏–¥—ë–º"],
            correctAnswers: { 1: "—Ö–æ–¥–∏–º", 2: "–∏–¥—ë–º" }
        },
        {
            instruction: "Completa la frase scegliendo 2 verbi adatti al contesto",
            text: "–ö—É–¥–∞ —Ç—ã {{1}}? –Ø {{2}} –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É.",
            words: ["—Ö–æ–¥–∏—à—å", "–∏–¥—ë—à—å", "—Ö–æ–∂—É", "–∏–¥—É"],
            correctAnswers: { 1: "–∏–¥—ë—à—å", 2: "–∏–¥—É" }
        },
        {
            instruction: "Completa la frase scegliendo 2  verbi adatti al contesto",
            text: " –¢—ã —á–∞—Å—Ç–æ —Å—é–¥–∞ {{1}}? –î–∞, —è {{2}} –≤ —ç—Ç–æ—Ç —Ä–µ—Å—Ç–æ—Ä–∞–Ω –∫–∞–∂–¥—É—é –Ω–µ–¥–µ–ª—é.",
            words: ["–∏–¥—ë—à—å", "—Ö–æ–¥–∏—à—å", "–∏–¥—É", "—Ö–æ–∂—É"],
            correctAnswers: { 1: "—Ö–æ–¥–∏—à—å", 2: "—Ö–æ–∂—É" }
        },
        {
            instruction: "Completa la frase scegliendo 2 verbi adatti al contesto",
            text: "–û–Ω–∞ {{1}} –ø–æ –±–µ—Ä–µ–≥—É –º–æ—Ä—è. –û–Ω–∞ —á–∞—Å—Ç–æ {{2}} –≥—É–ª—è—Ç—å –ø–æ –±–µ—Ä–µ–≥—É –º–æ—Ä—è.",
            words: ["—Ö–æ–¥–∏—Ç—å", "–∏–¥—ë—Ç", "—Ö–æ–¥–∏—Ç", "–∏–¥—ë—à—å"],
            correctAnswers: { 1: "–∏–¥—ë—Ç", 2: "—Ö–æ–¥–∏—Ç" }
        },
        {
            instruction: "Completa la frase scegliendo 2 verbi adatti al contesto",
            text: "–í—ã {{1}}  –Ω–∞ –∫–æ–Ω—Ü–µ—Ä—Ç —Å–µ–≥–æ–¥–Ω—è –≤–µ—á–µ—Ä–æ–º. –ú—ã —Ä–µ–¥–∫–æ {{2}} –Ω–∞ –∫–æ–Ω—Ü–µ—Ä—Ç—ã.",
            words: ["–∏–¥—ë–º", "—Ö–æ–¥–∏–º", "–∏–¥—ë—Ç–µ", "—Ö–æ–¥–∏—Ç–µ"],
            correctAnswers: { 1: "–∏–¥—ë—Ç–µ", 2: "—Ö–æ–¥–∏–º" }
        },
        {
            instruction: "Completa la frase scegliendo 2 espression–∏",
            text: "{{1}} –∑–æ–≤—É—Ç –ù–∏–∫–æ–ª–∞–π, –∞ {{2}} –∑–æ–≤—É—Ç –ö–∞—Ç—è.",
            words: ["–ò—Ö –¥—è–¥—é", "–µ–≥–æ –∂–µ–Ω–∞", "–µ–≥–æ –∂–µ–Ω—É", "–∏—Ö –¥—è–¥—è"],
            correctAnswers: { 1: "–ò—Ö –¥—è–¥—é", 2: "–µ–≥–æ –∂–µ–Ω—É" }
        },
        {
            instruction: "Completa la frase scegliendo 2 verbi adatti al contesto",
            text: "–¢–µ–±–µ –Ω—Ä–∞–≤–∏—Ç—å—Å—è {{1}} –≤ –∫–∏–Ω–æ? –ï—Å–ª–∏ —á–µ—Å—Ç–Ω–æ —è –æ—á–µ–Ω—å —Ä–µ–¥–∫–æ {{2}} –≤ –∫–∏–Ω–æ.",
            words: ["—Ö–æ–¥–∏—à—å", "—Ö–æ–¥–∏—Ç—å", "–∏–¥—Ç–∏","—Ö–æ–∂—É"],
            correctAnswers: { 1: "—Ö–æ–¥–∏—Ç—å", 2: "—Ö–æ–∂—É" }
        },
        {
            instruction: "Completa la frase scegliendo 2 verbi adarri al contesto",
            text: " –¢—ã –∫–∞–∂–¥—ã–π –¥–µ–Ω—å {{1}} –≤ —Å–ø–æ—Ä—Ç–∑–∞–ª? –ù–µ—Ç, –Ω–æ —Ç—Ä–∏ —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é {{2}}.",
            words: ["–º–æ–π –ø–∞—Ä–µ–Ω—å", "—Ö–æ–¥–∏—Ç", "–∏–¥—ë—Ç", "—Ö–æ–∂—É", "–∏–¥—É"],
            correctAnswers: { 1: "—Ö–æ–¥–∏—à—å", 2: "—Ö–æ–∂—É" }
        },
        {
            instruction: "Completa la frase scegliendo 2 verbi adatti al contesto",
            text: " –ö—É–¥–∞ –≤—ã {{1}} –≤ —Å—É–±–±–æ—Ç—É –≤–µ—á–µ—Ä–æ–º? –Ø {{2}} —Å –ø–æ–¥—Ä—É–≥–∞–º–∏ –≤ –∫–∏–Ω–æ, –ê–Ω–¥—Ä–µ–π - —Å–º–æ—Ç—Ä–µ—Ç—å —Ñ—É—Ç–±–æ–ª –≤ –±–∞—Ä.",
            words: ["–∏–¥—ë—Ç–µ", "—Ö–æ–¥–∏—Ç–µ", "—Ö–æ–∂—É", "–∏–¥—É"],
            correctAnswers: { 1: "–∏–¥—ë—Ç–µ", 2: "–∏–¥—É" }
        },
        {
            instruction: "Completa la frase scegliendo 2 verbi adatti al contesto",
            text: "–ü—Ä–∏–≤–µ—Ç, –∫–∞–∫–∏–º–∏ —Å—É–¥—å–±–∞–º–∏? –¢—ã —Ä–µ–¥–∫–æ {{1}} –≤ —ç—Ç–æ—Ç –±–∞—Ä. –ü—Ä–∏–≤–µ—Ç, —è {{2}} —Å—é–¥–∞ —á–∞—Å—Ç–æ, –Ω–æ –æ–±—ã—á–Ω–æ –ø–æ—Å–ª–µ –æ–±–µ–¥–∞",
            words: ["–∏–¥—ë—à—å", "—Ö–æ–¥–∏—à—å", "–∏–¥—ë—Ç", "—Ö–æ–∂—É"],
            correctAnswers: { 1: "—Ö–æ–¥–∏—à—å", 2: "—Ö–æ–∂—É" }
        }
    ];

    let currentExerciseIndex = 0;
    let checked = false;
    let gapElements = [];
    let wordElements = [];

    function loadExercise(index) {
        if (index >= exercises.length) {
            showCompletion();
            return;
        }

        checked = false;
        const exercise = exercises[index];

        exerciseContainer.innerHTML = `
            <div class="header">
                <div class="exercise-counter">Esercizio ${index + 1} di ${exercises.length}</div>
            </div>
            <div class="instruction">${exercise.instruction}</div>
            <div class="exercise-text" id="ex-dragdrop-plur-01-text">${exercise.text}</div>
            <div class="word-options" id="ex-dragdrop-plur-01-options"></div>
            <div class="controls">
                <button class="btn btn-primary" id="ex-dragdrop-plur-01-check">Verifica</button>
                <button class="btn btn-secondary" id="ex-dragdrop-plur-01-next" style="display:none;">Prossimo</button>
                <div class="feedback" id="ex-dragdrop-plur-01-feedback"></div>
            </div>
        `;

        const exerciseText = exerciseContainer.querySelector('#ex-dragdrop-plur-01-text');
        const wordOptionsContainer = exerciseContainer.querySelector('#ex-dragdrop-plur-01-options');
        const checkBtn = exerciseContainer.querySelector('#ex-dragdrop-plur-01-check');
        const nextBtn = exerciseContainer.querySelector('#ex-dragdrop-plur-01-next');
        const feedback = exerciseContainer.querySelector('#ex-dragdrop-plur-01-feedback');

        const placeholderPattern = /\{\{(\d+)\}\}/g;
        let textContent = exercise.text;

        textContent = textContent.replace(placeholderPattern, (match, number) => {
            return `<span class="gap" data-gap="${number}"></span>`;
        });

        exerciseText.innerHTML = textContent;

        gapElements = Array.from(exerciseText.querySelectorAll('.gap'));
        wordElements = [];

        exercise.words.forEach((word, idx) => {
            const wordElement = document.createElement('div');
            wordElement.className = 'word-option';
            wordElement.textContent = word;
            wordElement.dataset.word = word;
            wordElement.dataset.index = idx;
            wordElement.addEventListener('click', () => handleWordClick(wordElement));
            wordOptionsContainer.appendChild(wordElement);
            wordElements.push(wordElement);
        });

        gapElements.forEach(gap => {
            gap.addEventListener('click', () => handleGapClick(gap));
        });

        checkBtn.addEventListener('click', () => checkAnswers(exercise, feedback, nextBtn, checkBtn));
        nextBtn.addEventListener('click', () => {
            currentExerciseIndex++;
            loadExercise(currentExerciseIndex);
        });
    }

    function handleWordClick(wordElement) {
        if (wordElement.classList.contains('used') || checked) return;

        const emptyGap = gapElements.find(gap => !gap.classList.contains('filled'));
        if (!emptyGap) return;

        const word = wordElement.dataset.word;
        emptyGap.textContent = word;
        emptyGap.classList.add('filled');
        emptyGap.dataset.wordIndex = wordElement.dataset.index;
        emptyGap.dataset.word = word;
        wordElement.classList.add('used');
    }

    function handleGapClick(gap) {
        if (checked) return;
        if (!gap.classList.contains('filled')) return;

        const wordIndex = gap.dataset.wordIndex;
        const wordElement = wordElements.find(w => w.dataset.index === wordIndex);

        gap.textContent = '';
        gap.classList.remove('filled');
        delete gap.dataset.wordIndex;
        delete gap.dataset.word;

        if (wordElement) {
            wordElement.classList.remove('used');
        }
    }

    function checkAnswers(exercise, feedback, nextBtn, checkBtn) {
        checked = true;
        let correct = 0;
        let total = Object.keys(exercise.correctAnswers).length;

        gapElements.forEach(gap => {
            const gapNum = parseInt(gap.dataset.gap);
            const userAnswer = gap.dataset.word;
            const correctAnswer = exercise.correctAnswers[gapNum];

            if (userAnswer === correctAnswer) {
                gap.classList.remove('filled');
                gap.classList.add('correct');
                correct++;
            } else {
                gap.classList.add('incorrect');
            }
        });

        feedback.textContent = `Corretto: ${correct} / ${total}`;
        
        // –ú–µ–Ω—è–µ–º —Ü–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏
        if(correct === total) {
             feedback.style.color = "#22c55e"; // –ó–µ–ª–µ–Ω—ã–π
             feedback.textContent += " (Bravissimo!)";
        } else {
             feedback.style.color = "#ef4444"; // –ö—Ä–∞—Å–Ω—ã–π
        }

        checkBtn.style.display = 'none';
        nextBtn.style.display = 'inline-block';
    }

    function showCompletion() {
        exerciseContainer.style.display = 'none';
        completionScreen.style.display = 'block';

        completionScreen.innerHTML = `
            <div class="completion">
                <h2 style="font-family: 'League Spartan'; font-size: 2rem; color: #2a5bd7;">Complimenti!</h2>
                <p style="font-size: 1.2rem; margin-top: 1rem;">Hai completato tutti i ${exercises.length} esercizi.</p>
                <button class="btn btn-primary" onclick="location.reload()" style="margin-top: 2rem;">Ricomincia</button>
            </div>
        `;
    }

    loadExercise(currentExerciseIndex);
})();
            </script>
        </div>

        <!-- ============================================================ -->
        <!-- Panel 5 -->
        <!-- ============================================================ -->
        <article class="exercise-card" data-status="open" data-target="panel-acc-open-5">
            <span class="exercise-type">Drag &amp; Drop</span>
            <h3 class="exercise-title"><!-- TODO: Title --></h3>
        </article>

        <div class="exercise-panel" id="panel-acc-open-5" data-access="student" hidden>
            <section id="ex-dragdrop-plur-05">
                <div id="ex-dragdrop-plur-05-container">
                    <!-- TODO: Exercise content will be rendered here -->
                </div>
                <div id="ex-dragdrop-plur-05-completion" style="display:none;">
                    <!-- TODO: Completion screen -->
                </div>
            </section>
            <!-- TODO: Add drag & drop JS logic -->
        </div>

        <!-- ============================================================ -->
        <!-- Panel 6 -->
        <!-- ============================================================ -->
        <article class="exercise-card" data-status="open" data-target="panel-acc-open-6">
            <span class="exercise-type">Drag &amp; Drop</span>
            <h3 class="exercise-title"><!-- TODO: Title --></h3>
        </article>

        <div class="exercise-panel" id="panel-acc-open-6" data-access="paid" hidden>
            <section id="ex-dragdrop-plur-06">
                <div id="ex-dragdrop-plur-06-container">
                    <!-- TODO: Exercise content will be rendered here -->
                </div>
                <div id="ex-dragdrop-plur-06-completion" style="display:none;">
                    <!-- TODO: Completion screen -->
                </div>
            </section>
            <!-- TODO: Add drag & drop JS logic -->
        </div>

        <!-- ============================================================ -->
        <!-- Panel 2 -->
        <!-- ============================================================ -->
        <article class="exercise-card" data-status="open" data-target="panel-acc-open-2">
            <span class="exercise-type">FLASHCARDS</span>
            <h3 class="exercise-title"><!-- TODO: Title --></h3>
        </article>

        <div class="exercise-panel" id="panel-acc-open-2" data-access="public" hidden>
            <section id="ex-flashcards-plur-02">
                <div class="fca01-header">
                    <h2><!-- TODO: Header title --></h2>
                    <p>Scegliere modalit√†</p>
                </div>

                <div class="fca01-mode-buttons">
                    <button class="fca01-mode-btn active" data-mode="study">ESPLORARE</button>
                    <button class="fca01-mode-btn" data-mode="quiz">QUIZ</button>
                    <button class="fca01-mode-btn" data-mode="match">MATCH</button>
                </div>

                <div id="ex-flashcards-plur-02-section-study" class="fca01-section visible">
                    <div id="ex-flashcards-plur-02-learning-area-study"></div>
                    <div class="fca01-nav">
                        <button id="ex-flashcards-plur-02-prev-btn" class="fca01-btn-nav">‚Üê –ù–∞–∑–∞–¥</button>
                        <span id="ex-flashcards-plur-02-counter" class="fca01-counter">1 / 7</span>
                        <button id="ex-flashcards-plur-02-next-btn" class="btn btn-primary">–í–ø–µ—Ä–µ–¥ ‚Üí</button>
                    </div>
                </div>

                <div id="ex-flashcards-plur-02-section-quiz" class="fca01-section">
                    <div id="ex-flashcards-plur-02-learning-area-quiz"></div>
                    <div class="fca01-center-btn">
                        <button id="ex-flashcards-plur-02-start-quiz-btn" class="btn btn-primary hidden">–ù–æ–≤—ã–π –≤–æ–ø—Ä–æ—Å</button>
                    </div>
                </div>

                <div id="ex-flashcards-plur-02-section-match" class="fca01-section">
                    <div id="ex-flashcards-plur-02-learning-area-match"></div>
                    <div class="fca01-center-btn">
                        <button id="ex-flashcards-plur-02-reset-match-btn" class="btn btn-secondary">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
                    </div>
                </div>
            </section>

            <script type="text/plain" data-lazy-script="panel-acc-open-2">
(() => {
    const rootEl = document.getElementById('ex-flashcards-plur-02');
    if (!rootEl) {
        console.warn('‚ö†Ô∏è Flashcards: Container #ex-flashcards-plur-02 NOT FOUND');
        return;
    }

    function initFlashcardsPlur02(root) {
        const flashcardsData = [
            // TODO: Add flashcard data
            // { front: "...", back: "..." },
        ];

        let currentMode = 'study';
        let currentIndex = 0;
        let selectedMatchCard = null;
        let isProcessingMatch = false;
        let cachedRuVoice = null;

        function pickRuVoice() {
            const voices = window.speechSynthesis.getVoices();
            const ruVoice = voices.find(v => v.lang.includes('ru'));
            if (ruVoice) cachedRuVoice = ruVoice;
        }

        function textToSpeech(text, lang = 'ru-RU') {
            if (!('speechSynthesis' in window)) return;
            window.speechSynthesis.cancel();
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = lang;
            utterance.rate = 0.9;
            utterance.pitch = 1;
            utterance.volume = 1;
            if (cachedRuVoice) utterance.voice = cachedRuVoice;
            window.speechSynthesis.speak(utterance);
        }

        function playAudio(text, event) {
            event.stopPropagation();
            textToSpeech(text);
        }

        function switchMode(mode) {
            currentMode = mode;
            root.querySelectorAll('.fca01-mode-btn').forEach(btn => btn.classList.remove('active'));
            root.querySelectorAll('.fca01-section').forEach(sec => sec.classList.remove('visible'));
            root.querySelector(`#ex-flashcards-plur-02-section-${mode}`).classList.add('visible');
            root.querySelector(`[data-mode="${mode}"]`).classList.add('active');

            if (mode === 'study') { currentIndex = 0; renderCard(); }
            else if (mode === 'quiz') { renderQuiz(); root.querySelector('#ex-flashcards-plur-02-start-quiz-btn').classList.add('hidden'); }
            else if (mode === 'match') { initMatchGame(); }
        }

        function renderCard() {
            const area = root.querySelector('#ex-flashcards-plur-02-learning-area-study');
            const counter = root.querySelector('#ex-flashcards-plur-02-counter');
            const cardData = flashcardsData[currentIndex];

            counter.textContent = `${currentIndex + 1} / ${flashcardsData.length}`;
            area.innerHTML = `
                <div class="fca01-card-container">
                    <div class="fca01-card">
                        <div class="fca01-card-face fca01-card-front">
                            <button class="fca01-audio-btn" data-text="${cardData.front}">üîä</button>
                            ${cardData.front}
                        </div>
                        <div class="fca01-card-face fca01-card-back">
                            <button class="fca01-audio-btn" data-text="${cardData.back}">üîä</button>
                            ${cardData.back}
                        </div>
                    </div>
                </div>
            `;

            const card = area.querySelector('.fca01-card');
            card.addEventListener('click', function() {
                this.classList.toggle('is-flipped');
            });

            area.querySelectorAll('.fca01-audio-btn').forEach(btn => {
                btn.addEventListener('click', (e) => playAudio(btn.dataset.text, e));
            });
        }

        function nextCard() {
            currentIndex = (currentIndex + 1) % flashcardsData.length;
            renderCard();
        }

        function prevCard() {
            currentIndex = currentIndex > 0 ? currentIndex - 1 : flashcardsData.length - 1;
            renderCard();
        }

        function renderQuiz() {
            const area = root.querySelector('#ex-flashcards-plur-02-learning-area-quiz');
            root.querySelector('#ex-flashcards-plur-02-start-quiz-btn').classList.add('hidden');

            const randomIndex = Math.floor(Math.random() * flashcardsData.length);
            const correctCard = flashcardsData[randomIndex];

            let options = [correctCard];
            while (options.length < 3 && options.length < flashcardsData.length) {
                const randomWrong = flashcardsData[Math.floor(Math.random() * flashcardsData.length)];
                if (!options.some(opt => opt.back === randomWrong.back)) options.push(randomWrong);
            }
            options.sort(() => Math.random() - 0.5);

            const buttonsHTML = options.map(opt =>
                `<button class="fca01-quiz-option" data-answer="${opt.back}" data-correct="${correctCard.back}">
                    ${opt.back}
                </button>`
            ).join('');

            area.innerHTML = `
                <div class="fca01-quiz-area">
                    <h3 class="fca01-quiz-question">–ù–∞–π–¥–∏ –≤—Ç–æ—Ä—É—é —á–∞—Å—Ç—å: <br><span class="highlight">"${correctCard.front}"</span></h3>
                    <div class="fca01-quiz-options">${buttonsHTML}</div>
                    <p class="fca01-quiz-feedback"></p>
                </div>
            `;

            area.querySelectorAll('.fca01-quiz-option').forEach(btn => {
                btn.addEventListener('click', function() {
                    checkQuizAnswer(this.dataset.answer, this.dataset.correct, this);
                });
            });
        }

        function checkQuizAnswer(selected, correct, btnElement) {
            const feedback = root.querySelector('.fca01-quiz-feedback');
            const nextBtn = root.querySelector('#ex-flashcards-plur-02-start-quiz-btn');

            root.querySelectorAll('.fca01-quiz-option').forEach(btn => {
                btn.style.pointerEvents = 'none';
                if (btn.dataset.answer === correct) btn.classList.add('correct');
            });

            if (selected === correct) {
                feedback.textContent = "‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ!";
                feedback.className = "fca01-quiz-feedback correct";
            } else {
                btnElement.classList.add('wrong');
                feedback.textContent = "‚ùå –û—à–∏–±–∫–∞!";
                feedback.className = "fca01-quiz-feedback wrong";
            }
            nextBtn.classList.remove('hidden');
        }

        function initMatchGame() {
            const area = root.querySelector('#ex-flashcards-plur-02-learning-area-match');
            selectedMatchCard = null;
            isProcessingMatch = false;

            let fronts = flashcardsData.map((card, index) => ({ text: card.front, type: 'front', id: index }));
            let backs = flashcardsData.map((card, index) => ({ text: card.back, type: 'back', id: index }));

            fronts.sort(() => Math.random() - 0.5);
            backs.sort(() => Math.random() - 0.5);

            area.innerHTML = `
                <div class="fca01-match-container">
                    <p class="fca01-match-feedback"></p>
                    <div class="fca01-match-grid">
                        <div class="fca01-match-col" id="ex-flashcards-plur-02-match-col-fronts"></div>
                        <div class="fca01-match-col" id="ex-flashcards-plur-02-match-col-backs"></div>
                    </div>
                </div>
            `;

            const colFronts = root.querySelector('#ex-flashcards-plur-02-match-col-fronts');
            const colBacks = root.querySelector('#ex-flashcards-plur-02-match-col-backs');

            function createMatchElement(item) {
                const div = document.createElement('div');
                div.className = 'fca01-match-card';
                div.textContent = item.text;
                div.dataset.id = item.id;
                div.dataset.type = item.type;
                div.addEventListener('click', () => handleMatchClick(div));
                return div;
            }

            fronts.forEach(item => colFronts.appendChild(createMatchElement(item)));
            backs.forEach(item => colBacks.appendChild(createMatchElement(item)));
        }

        function handleMatchClick(clickedCard) {
            if (isProcessingMatch || clickedCard.classList.contains('matched')) return;
            if (clickedCard === selectedMatchCard) return;

            const feedbackEl = root.querySelector('.fca01-match-feedback');

            if (!selectedMatchCard) {
                selectedMatchCard = clickedCard;
                clickedCard.classList.add('selected');
                return;
            }

            if (selectedMatchCard.dataset.type === clickedCard.dataset.type) {
                selectedMatchCard.classList.remove('selected');
                selectedMatchCard = clickedCard;
                clickedCard.classList.add('selected');
                return;
            }

            const firstId = selectedMatchCard.dataset.id;
            const secondId = clickedCard.dataset.id;
            const previousCard = selectedMatchCard;

            if (firstId === secondId) {
                previousCard.classList.add('matched');
                clickedCard.classList.add('matched');
                feedbackEl.textContent = "‚ú® –û—Ç–ª–∏—á–Ω–æ!";
                feedbackEl.className = "fca01-match-feedback correct";
                selectedMatchCard = null;
                setTimeout(() => { feedbackEl.textContent = ""; }, 1000);

                const remaining = root.querySelectorAll('.fca01-match-card:not(.matched)').length;
                if (remaining === 0) feedbackEl.textContent = "üéâ –ü–û–ë–ï–î–ê! üéâ";
            } else {
                isProcessingMatch = true;
                clickedCard.classList.add('wrong');
                previousCard.classList.add('wrong');
                feedbackEl.textContent = "–ù–µ–≤–µ—Ä–Ω–æ";
                feedbackEl.className = "fca01-match-feedback wrong";

                setTimeout(() => {
                    clickedCard.classList.remove('selected', 'wrong');
                    previousCard.classList.remove('selected', 'wrong');
                    feedbackEl.textContent = "";
                    isProcessingMatch = false;
                }, 800);

                selectedMatchCard = null;
            }
        }

        pickRuVoice();
        if (!cachedRuVoice) {
            window.speechSynthesis.onvoiceschanged = () => {
                pickRuVoice();
                window.speechSynthesis.onvoiceschanged = null;
            };
        }

        root.querySelectorAll('.fca01-mode-btn').forEach(btn => {
            btn.addEventListener('click', () => switchMode(btn.dataset.mode));
        });

        root.querySelector('#ex-flashcards-plur-02-next-btn').addEventListener('click', nextCard);
        root.querySelector('#ex-flashcards-plur-02-prev-btn').addEventListener('click', prevCard);
        root.querySelector('#ex-flashcards-plur-02-start-quiz-btn').addEventListener('click', renderQuiz);
        root.querySelector('#ex-flashcards-plur-02-reset-match-btn').addEventListener('click', initMatchGame);

        switchMode('study');
    }

    initFlashcardsPlur02(rootEl);
})();
            </script>
        </div>

        <!-- ============================================================ -->
        <!-- Panel 7 -->
        <!-- ============================================================ -->
        <article class="exercise-card" data-status="open" data-target="panel-acc-open-7">
            <span class="exercise-type">FLASHCARDS</span>
            <h3 class="exercise-title"><!-- TODO: Title --></h3>
        </article>

        <div class="exercise-panel" id="panel-acc-open-7" data-access="student" hidden>
            <section id="ex-flashcards-plur-07">
                <div class="fca01-header">
                    <h2><!-- TODO: Header title --></h2>
                    <p>Scegliere modalit√†</p>
                </div>

                <div class="fca01-mode-buttons">
                    <button class="fca01-mode-btn active" data-mode="study">ESPLORARE</button>
                    <button class="fca01-mode-btn" data-mode="quiz">QUIZ</button>
                    <button class="fca01-mode-btn" data-mode="match">MATCH</button>
                </div>

                <div id="ex-flashcards-plur-07-section-study" class="fca01-section visible">
                    <div id="ex-flashcards-plur-07-learning-area-study"></div>
                    <div class="fca01-nav">
                        <button id="ex-flashcards-plur-07-prev-btn" class="fca01-btn-nav">‚Üê –ù–∞–∑–∞–¥</button>
                        <span id="ex-flashcards-plur-07-counter" class="fca01-counter">1 / 7</span>
                        <button id="ex-flashcards-plur-07-next-btn" class="btn btn-primary">–í–ø–µ—Ä–µ–¥ ‚Üí</button>
                    </div>
                </div>

                <div id="ex-flashcards-plur-07-section-quiz" class="fca01-section">
                    <div id="ex-flashcards-plur-07-learning-area-quiz"></div>
                    <div class="fca01-center-btn">
                        <button id="ex-flashcards-plur-07-start-quiz-btn" class="btn btn-primary hidden">–ù–æ–≤—ã–π –≤–æ–ø—Ä–æ—Å</button>
                    </div>
                </div>

                <div id="ex-flashcards-plur-07-section-match" class="fca01-section">
                    <div id="ex-flashcards-plur-07-learning-area-match"></div>
                    <div class="fca01-center-btn">
                        <button id="ex-flashcards-plur-07-reset-match-btn" class="btn btn-secondary">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
                    </div>
                </div>
            </section>

            <script type="text/plain" data-lazy-script="panel-acc-open-7">
(() => {
    const rootEl = document.getElementById('ex-flashcards-plur-07');
    if (!rootEl) {
        console.warn('‚ö†Ô∏è Flashcards: Container #ex-flashcards-plur-07 NOT FOUND');
        return;
    }

    function initFlashcardsPlur07(root) {
        const flashcardsData = [
            // TODO: Add flashcard data
            // { front: "...", back: "..." },
        ];

        let currentMode = 'study';
        let currentIndex = 0;
        let selectedMatchCard = null;
        let isProcessingMatch = false;
        let cachedRuVoice = null;

        function pickRuVoice() {
            const voices = window.speechSynthesis.getVoices();
            const ruVoice = voices.find(v => v.lang.includes('ru'));
            if (ruVoice) cachedRuVoice = ruVoice;
        }

        function textToSpeech(text, lang = 'ru-RU') {
            if (!('speechSynthesis' in window)) return;
            window.speechSynthesis.cancel();
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = lang;
            utterance.rate = 0.9;
            utterance.pitch = 1;
            utterance.volume = 1;
            if (cachedRuVoice) utterance.voice = cachedRuVoice;
            window.speechSynthesis.speak(utterance);
        }

        function playAudio(text, event) {
            event.stopPropagation();
            textToSpeech(text);
        }

        function switchMode(mode) {
            currentMode = mode;
            root.querySelectorAll('.fca01-mode-btn').forEach(btn => btn.classList.remove('active'));
            root.querySelectorAll('.fca01-section').forEach(sec => sec.classList.remove('visible'));
            root.querySelector(`#ex-flashcards-plur-07-section-${mode}`).classList.add('visible');
            root.querySelector(`[data-mode="${mode}"]`).classList.add('active');

            if (mode === 'study') { currentIndex = 0; renderCard(); }
            else if (mode === 'quiz') { renderQuiz(); root.querySelector('#ex-flashcards-plur-07-start-quiz-btn').classList.add('hidden'); }
            else if (mode === 'match') { initMatchGame(); }
        }

        function renderCard() {
            const area = root.querySelector('#ex-flashcards-plur-07-learning-area-study');
            const counter = root.querySelector('#ex-flashcards-plur-07-counter');
            const cardData = flashcardsData[currentIndex];

            counter.textContent = `${currentIndex + 1} / ${flashcardsData.length}`;
            area.innerHTML = `
                <div class="fca01-card-container">
                    <div class="fca01-card">
                        <div class="fca01-card-face fca01-card-front">
                            <button class="fca01-audio-btn" data-text="${cardData.front}">üîä</button>
                            ${cardData.front}
                        </div>
                        <div class="fca01-card-face fca01-card-back">
                            <button class="fca01-audio-btn" data-text="${cardData.back}">üîä</button>
                            ${cardData.back}
                        </div>
                    </div>
                </div>
            `;

            const card = area.querySelector('.fca01-card');
            card.addEventListener('click', function() {
                this.classList.toggle('is-flipped');
            });

            area.querySelectorAll('.fca01-audio-btn').forEach(btn => {
                btn.addEventListener('click', (e) => playAudio(btn.dataset.text, e));
            });
        }

        function nextCard() {
            currentIndex = (currentIndex + 1) % flashcardsData.length;
            renderCard();
        }

        function prevCard() {
            currentIndex = currentIndex > 0 ? currentIndex - 1 : flashcardsData.length - 1;
            renderCard();
        }

        function renderQuiz() {
            const area = root.querySelector('#ex-flashcards-plur-07-learning-area-quiz');
            root.querySelector('#ex-flashcards-plur-07-start-quiz-btn').classList.add('hidden');

            const randomIndex = Math.floor(Math.random() * flashcardsData.length);
            const correctCard = flashcardsData[randomIndex];

            let options = [correctCard];
            while (options.length < 3 && options.length < flashcardsData.length) {
                const randomWrong = flashcardsData[Math.floor(Math.random() * flashcardsData.length)];
                if (!options.some(opt => opt.back === randomWrong.back)) options.push(randomWrong);
            }
            options.sort(() => Math.random() - 0.5);

            const buttonsHTML = options.map(opt =>
                `<button class="fca01-quiz-option" data-answer="${opt.back}" data-correct="${correctCard.back}">
                    ${opt.back}
                </button>`
            ).join('');

            area.innerHTML = `
                <div class="fca01-quiz-area">
                    <h3 class="fca01-quiz-question">–ù–∞–π–¥–∏ –≤—Ç–æ—Ä—É—é —á–∞—Å—Ç—å: <br><span class="highlight">"${correctCard.front}"</span></h3>
                    <div class="fca01-quiz-options">${buttonsHTML}</div>
                    <p class="fca01-quiz-feedback"></p>
                </div>
            `;

            area.querySelectorAll('.fca01-quiz-option').forEach(btn => {
                btn.addEventListener('click', function() {
                    checkQuizAnswer(this.dataset.answer, this.dataset.correct, this);
                });
            });
        }

        function checkQuizAnswer(selected, correct, btnElement) {
            const feedback = root.querySelector('.fca01-quiz-feedback');
            const nextBtn = root.querySelector('#ex-flashcards-plur-07-start-quiz-btn');

            root.querySelectorAll('.fca01-quiz-option').forEach(btn => {
                btn.style.pointerEvents = 'none';
                if (btn.dataset.answer === correct) btn.classList.add('correct');
            });

            if (selected === correct) {
                feedback.textContent = "‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ!";
                feedback.className = "fca01-quiz-feedback correct";
            } else {
                btnElement.classList.add('wrong');
                feedback.textContent = "‚ùå –û—à–∏–±–∫–∞!";
                feedback.className = "fca01-quiz-feedback wrong";
            }
            nextBtn.classList.remove('hidden');
        }

        function initMatchGame() {
            const area = root.querySelector('#ex-flashcards-plur-07-learning-area-match');
            selectedMatchCard = null;
            isProcessingMatch = false;

            let fronts = flashcardsData.map((card, index) => ({ text: card.front, type: 'front', id: index }));
            let backs = flashcardsData.map((card, index) => ({ text: card.back, type: 'back', id: index }));

            fronts.sort(() => Math.random() - 0.5);
            backs.sort(() => Math.random() - 0.5);

            area.innerHTML = `
                <div class="fca01-match-container">
                    <p class="fca01-match-feedback"></p>
                    <div class="fca01-match-grid">
                        <div class="fca01-match-col" id="ex-flashcards-plur-07-match-col-fronts"></div>
                        <div class="fca01-match-col" id="ex-flashcards-plur-07-match-col-backs"></div>
                    </div>
                </div>
            `;

            const colFronts = root.querySelector('#ex-flashcards-plur-07-match-col-fronts');
            const colBacks = root.querySelector('#ex-flashcards-plur-07-match-col-backs');

            function createMatchElement(item) {
                const div = document.createElement('div');
                div.className = 'fca01-match-card';
                div.textContent = item.text;
                div.dataset.id = item.id;
                div.dataset.type = item.type;
                div.addEventListener('click', () => handleMatchClick(div));
                return div;
            }

            fronts.forEach(item => colFronts.appendChild(createMatchElement(item)));
            backs.forEach(item => colBacks.appendChild(createMatchElement(item)));
        }

        function handleMatchClick(clickedCard) {
            if (isProcessingMatch || clickedCard.classList.contains('matched')) return;
            if (clickedCard === selectedMatchCard) return;

            const feedbackEl = root.querySelector('.fca01-match-feedback');

            if (!selectedMatchCard) {
                selectedMatchCard = clickedCard;
                clickedCard.classList.add('selected');
                return;
            }

            if (selectedMatchCard.dataset.type === clickedCard.dataset.type) {
                selectedMatchCard.classList.remove('selected');
                selectedMatchCard = clickedCard;
                clickedCard.classList.add('selected');
                return;
            }

            const firstId = selectedMatchCard.dataset.id;
            const secondId = clickedCard.dataset.id;
            const previousCard = selectedMatchCard;

            if (firstId === secondId) {
                previousCard.classList.add('matched');
                clickedCard.classList.add('matched');
                feedbackEl.textContent = "‚ú® –û—Ç–ª–∏—á–Ω–æ!";
                feedbackEl.className = "fca01-match-feedback correct";
                selectedMatchCard = null;
                setTimeout(() => { feedbackEl.textContent = ""; }, 1000);

                const remaining = root.querySelectorAll('.fca01-match-card:not(.matched)').length;
                if (remaining === 0) feedbackEl.textContent = "üéâ –ü–û–ë–ï–î–ê! üéâ";
            } else {
                isProcessingMatch = true;
                clickedCard.classList.add('wrong');
                previousCard.classList.add('wrong');
                feedbackEl.textContent = "–ù–µ–≤–µ—Ä–Ω–æ";
                feedbackEl.className = "fca01-match-feedback wrong";

                setTimeout(() => {
                    clickedCard.classList.remove('selected', 'wrong');
                    previousCard.classList.remove('selected', 'wrong');
                    feedbackEl.textContent = "";
                    isProcessingMatch = false;
                }, 800);

                selectedMatchCard = null;
            }
        }

        pickRuVoice();
        if (!cachedRuVoice) {
            window.speechSynthesis.onvoiceschanged = () => {
                pickRuVoice();
                window.speechSynthesis.onvoiceschanged = null;
            };
        }

        root.querySelectorAll('.fca01-mode-btn').forEach(btn => {
            btn.addEventListener('click', () => switchMode(btn.dataset.mode));
        });

        root.querySelector('#ex-flashcards-plur-07-next-btn').addEventListener('click', nextCard);
        root.querySelector('#ex-flashcards-plur-07-prev-btn').addEventListener('click', prevCard);
        root.querySelector('#ex-flashcards-plur-07-start-quiz-btn').addEventListener('click', renderQuiz);
        root.querySelector('#ex-flashcards-plur-07-reset-match-btn').addEventListener('click', initMatchGame);

        switchMode('study');
    }

    initFlashcardsPlur07(rootEl);
})();
            </script>
        </div>

        <!-- ============================================================ -->
        <!-- Panel 8 -->
        <!-- ============================================================ -->
        <article class="exercise-card" data-status="open" data-target="panel-acc-open-8">
            <span class="exercise-type">FLASHCARDS</span>
            <h3 class="exercise-title"><!-- TODO: Title --></h3>
        </article>

        <div class="exercise-panel" id="panel-acc-open-8" data-access="paid" hidden>
            <section id="ex-flashcards-plur-08">
                <div class="fca01-header">
                    <h2><!-- TODO: Header title --></h2>
                    <p>Scegliere modalit√†</p>
                </div>

                <div class="fca01-mode-buttons">
                    <button class="fca01-mode-btn active" data-mode="study">ESPLORARE</button>
                    <button class="fca01-mode-btn" data-mode="quiz">QUIZ</button>
                    <button class="fca01-mode-btn" data-mode="match">MATCH</button>
                </div>

                <div id="ex-flashcards-plur-08-section-study" class="fca01-section visible">
                    <div id="ex-flashcards-plur-08-learning-area-study"></div>
                    <div class="fca01-nav">
                        <button id="ex-flashcards-plur-08-prev-btn" class="fca01-btn-nav">‚Üê –ù–∞–∑–∞–¥</button>
                        <span id="ex-flashcards-plur-08-counter" class="fca01-counter">1 / 7</span>
                        <button id="ex-flashcards-plur-08-next-btn" class="btn btn-primary">–í–ø–µ—Ä–µ–¥ ‚Üí</button>
                    </div>
                </div>

                <div id="ex-flashcards-plur-08-section-quiz" class="fca01-section">
                    <div id="ex-flashcards-plur-08-learning-area-quiz"></div>
                    <div class="fca01-center-btn">
                        <button id="ex-flashcards-plur-08-start-quiz-btn" class="btn btn-primary hidden">–ù–æ–≤—ã–π –≤–æ–ø—Ä–æ—Å</button>
                    </div>
                </div>

                <div id="ex-flashcards-plur-08-section-match" class="fca01-section">
                    <div id="ex-flashcards-plur-08-learning-area-match"></div>
                    <div class="fca01-center-btn">
                        <button id="ex-flashcards-plur-08-reset-match-btn" class="btn btn-secondary">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
                    </div>
                </div>
            </section>

            <script type="text/plain" data-lazy-script="panel-acc-open-8">
(() => {
    const rootEl = document.getElementById('ex-flashcards-plur-08');
    if (!rootEl) {
        console.warn('‚ö†Ô∏è Flashcards: Container #ex-flashcards-plur-08 NOT FOUND');
        return;
    }

    function initFlashcardsPlur08(root) {
        const flashcardsData = [
            // TODO: Add flashcard data
            // { front: "...", back: "..." },
        ];

        let currentMode = 'study';
        let currentIndex = 0;
        let selectedMatchCard = null;
        let isProcessingMatch = false;
        let cachedRuVoice = null;

        function pickRuVoice() {
            const voices = window.speechSynthesis.getVoices();
            const ruVoice = voices.find(v => v.lang.includes('ru'));
            if (ruVoice) cachedRuVoice = ruVoice;
        }

        function textToSpeech(text, lang = 'ru-RU') {
            if (!('speechSynthesis' in window)) return;
            window.speechSynthesis.cancel();
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = lang;
            utterance.rate = 0.9;
            utterance.pitch = 1;
            utterance.volume = 1;
            if (cachedRuVoice) utterance.voice = cachedRuVoice;
            window.speechSynthesis.speak(utterance);
        }

        function playAudio(text, event) {
            event.stopPropagation();
            textToSpeech(text);
        }

        function switchMode(mode) {
            currentMode = mode;
            root.querySelectorAll('.fca01-mode-btn').forEach(btn => btn.classList.remove('active'));
            root.querySelectorAll('.fca01-section').forEach(sec => sec.classList.remove('visible'));
            root.querySelector(`#ex-flashcards-plur-08-section-${mode}`).classList.add('visible');
            root.querySelector(`[data-mode="${mode}"]`).classList.add('active');

            if (mode === 'study') { currentIndex = 0; renderCard(); }
            else if (mode === 'quiz') { renderQuiz(); root.querySelector('#ex-flashcards-plur-08-start-quiz-btn').classList.add('hidden'); }
            else if (mode === 'match') { initMatchGame(); }
        }

        function renderCard() {
            const area = root.querySelector('#ex-flashcards-plur-08-learning-area-study');
            const counter = root.querySelector('#ex-flashcards-plur-08-counter');
            const cardData = flashcardsData[currentIndex];

            counter.textContent = `${currentIndex + 1} / ${flashcardsData.length}`;
            area.innerHTML = `
                <div class="fca01-card-container">
                    <div class="fca01-card">
                        <div class="fca01-card-face fca01-card-front">
                            <button class="fca01-audio-btn" data-text="${cardData.front}">üîä</button>
                            ${cardData.front}
                        </div>
                        <div class="fca01-card-face fca01-card-back">
                            <button class="fca01-audio-btn" data-text="${cardData.back}">üîä</button>
                            ${cardData.back}
                        </div>
                    </div>
                </div>
            `;

            const card = area.querySelector('.fca01-card');
            card.addEventListener('click', function() {
                this.classList.toggle('is-flipped');
            });

            area.querySelectorAll('.fca01-audio-btn').forEach(btn => {
                btn.addEventListener('click', (e) => playAudio(btn.dataset.text, e));
            });
        }

        function nextCard() {
            currentIndex = (currentIndex + 1) % flashcardsData.length;
            renderCard();
        }

        function prevCard() {
            currentIndex = currentIndex > 0 ? currentIndex - 1 : flashcardsData.length - 1;
            renderCard();
        }

        function renderQuiz() {
            const area = root.querySelector('#ex-flashcards-plur-08-learning-area-quiz');
            root.querySelector('#ex-flashcards-plur-08-start-quiz-btn').classList.add('hidden');

            const randomIndex = Math.floor(Math.random() * flashcardsData.length);
            const correctCard = flashcardsData[randomIndex];

            let options = [correctCard];
            while (options.length < 3 && options.length < flashcardsData.length) {
                const randomWrong = flashcardsData[Math.floor(Math.random() * flashcardsData.length)];
                if (!options.some(opt => opt.back === randomWrong.back)) options.push(randomWrong);
            }
            options.sort(() => Math.random() - 0.5);

            const buttonsHTML = options.map(opt =>
                `<button class="fca01-quiz-option" data-answer="${opt.back}" data-correct="${correctCard.back}">
                    ${opt.back}
                </button>`
            ).join('');

            area.innerHTML = `
                <div class="fca01-quiz-area">
                    <h3 class="fca01-quiz-question">–ù–∞–π–¥–∏ –≤—Ç–æ—Ä—É—é —á–∞—Å—Ç—å: <br><span class="highlight">"${correctCard.front}"</span></h3>
                    <div class="fca01-quiz-options">${buttonsHTML}</div>
                    <p class="fca01-quiz-feedback"></p>
                </div>
            `;

            area.querySelectorAll('.fca01-quiz-option').forEach(btn => {
                btn.addEventListener('click', function() {
                    checkQuizAnswer(this.dataset.answer, this.dataset.correct, this);
                });
            });
        }

        function checkQuizAnswer(selected, correct, btnElement) {
            const feedback = root.querySelector('.fca01-quiz-feedback');
            const nextBtn = root.querySelector('#ex-flashcards-plur-08-start-quiz-btn');

            root.querySelectorAll('.fca01-quiz-option').forEach(btn => {
                btn.style.pointerEvents = 'none';
                if (btn.dataset.answer === correct) btn.classList.add('correct');
            });

            if (selected === correct) {
                feedback.textContent = "‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ!";
                feedback.className = "fca01-quiz-feedback correct";
            } else {
                btnElement.classList.add('wrong');
                feedback.textContent = "‚ùå –û—à–∏–±–∫–∞!";
                feedback.className = "fca01-quiz-feedback wrong";
            }
            nextBtn.classList.remove('hidden');
        }

        function initMatchGame() {
            const area = root.querySelector('#ex-flashcards-plur-08-learning-area-match');
            selectedMatchCard = null;
            isProcessingMatch = false;

            let fronts = flashcardsData.map((card, index) => ({ text: card.front, type: 'front', id: index }));
            let backs = flashcardsData.map((card, index) => ({ text: card.back, type: 'back', id: index }));

            fronts.sort(() => Math.random() - 0.5);
            backs.sort(() => Math.random() - 0.5);

            area.innerHTML = `
                <div class="fca01-match-container">
                    <p class="fca01-match-feedback"></p>
                    <div class="fca01-match-grid">
                        <div class="fca01-match-col" id="ex-flashcards-plur-08-match-col-fronts"></div>
                        <div class="fca01-match-col" id="ex-flashcards-plur-08-match-col-backs"></div>
                    </div>
                </div>
            `;

            const colFronts = root.querySelector('#ex-flashcards-plur-08-match-col-fronts');
            const colBacks = root.querySelector('#ex-flashcards-plur-08-match-col-backs');

            function createMatchElement(item) {
                const div = document.createElement('div');
                div.className = 'fca01-match-card';
                div.textContent = item.text;
                div.dataset.id = item.id;
                div.dataset.type = item.type;
                div.addEventListener('click', () => handleMatchClick(div));
                return div;
            }

            fronts.forEach(item => colFronts.appendChild(createMatchElement(item)));
            backs.forEach(item => colBacks.appendChild(createMatchElement(item)));
        }

        function handleMatchClick(clickedCard) {
            if (isProcessingMatch || clickedCard.classList.contains('matched')) return;
            if (clickedCard === selectedMatchCard) return;

            const feedbackEl = root.querySelector('.fca01-match-feedback');

            if (!selectedMatchCard) {
                selectedMatchCard = clickedCard;
                clickedCard.classList.add('selected');
                return;
            }

            if (selectedMatchCard.dataset.type === clickedCard.dataset.type) {
                selectedMatchCard.classList.remove('selected');
                selectedMatchCard = clickedCard;
                clickedCard.classList.add('selected');
                return;
            }

            const firstId = selectedMatchCard.dataset.id;
            const secondId = clickedCard.dataset.id;
            const previousCard = selectedMatchCard;

            if (firstId === secondId) {
                previousCard.classList.add('matched');
                clickedCard.classList.add('matched');
                feedbackEl.textContent = "‚ú® –û—Ç–ª–∏—á–Ω–æ!";
                feedbackEl.className = "fca01-match-feedback correct";
                selectedMatchCard = null;
                setTimeout(() => { feedbackEl.textContent = ""; }, 1000);

                const remaining = root.querySelectorAll('.fca01-match-card:not(.matched)').length;
                if (remaining === 0) feedbackEl.textContent = "üéâ –ü–û–ë–ï–î–ê! üéâ";
            } else {
                isProcessingMatch = true;
                clickedCard.classList.add('wrong');
                previousCard.classList.add('wrong');
                feedbackEl.textContent = "–ù–µ–≤–µ—Ä–Ω–æ";
                feedbackEl.className = "fca01-match-feedback wrong";

                setTimeout(() => {
                    clickedCard.classList.remove('selected', 'wrong');
                    previousCard.classList.remove('selected', 'wrong');
                    feedbackEl.textContent = "";
                    isProcessingMatch = false;
                }, 800);

                selectedMatchCard = null;
            }
        }

        pickRuVoice();
        if (!cachedRuVoice) {
            window.speechSynthesis.onvoiceschanged = () => {
                pickRuVoice();
                window.speechSynthesis.onvoiceschanged = null;
            };
        }

        root.querySelectorAll('.fca01-mode-btn').forEach(btn => {
            btn.addEventListener('click', () => switchMode(btn.dataset.mode));
        });

        root.querySelector('#ex-flashcards-plur-08-next-btn').addEventListener('click', nextCard);
        root.querySelector('#ex-flashcards-plur-08-prev-btn').addEventListener('click', prevCard);
        root.querySelector('#ex-flashcards-plur-08-start-quiz-btn').addEventListener('click', renderQuiz);
        root.querySelector('#ex-flashcards-plur-08-reset-match-btn').addEventListener('click', initMatchGame);

        switchMode('study');
    }

    initFlashcardsPlur08(rootEl);
})();
            </script>
        </div>

        <!-- ============================================================ -->
        <!-- Panel 3 -->
        <!-- ============================================================ -->
        <article class="exercise-card" data-status="open" data-target="panel-acc-open-3">
            <span class="exercise-type">FLASHCARDS</span>
            <h3 class="exercise-title"><!-- TODO: Title --></h3>
        </article>

        <div class="exercise-panel" id="panel-acc-open-3" data-access="public" hidden>
            <section id="ex-flashcards-plur-03">
                <div class="fca01-header">
                    <h2><!-- TODO: Header title --></h2>
                    <p>Scegliere modalit√†</p>
                </div>

                <div class="fca01-mode-buttons">
                    <button class="fca01-mode-btn active" data-mode="study">ESPLORARE</button>
                    <button class="fca01-mode-btn" data-mode="quiz">QUIZ</button>
                    <button class="fca01-mode-btn" data-mode="match">MATCH</button>
                </div>

                <div id="ex-flashcards-plur-03-section-study" class="fca01-section visible">
                    <div id="ex-flashcards-plur-03-learning-area-study"></div>
                    <div class="fca01-nav">
                        <button id="ex-flashcards-plur-03-prev-btn" class="fca01-btn-nav">‚Üê –ù–∞–∑–∞–¥</button>
                        <span id="ex-flashcards-plur-03-counter" class="fca01-counter">1 / 7</span>
                        <button id="ex-flashcards-plur-03-next-btn" class="btn btn-primary">–í–ø–µ—Ä–µ–¥ ‚Üí</button>
                    </div>
                </div>

                <div id="ex-flashcards-plur-03-section-quiz" class="fca01-section">
                    <div id="ex-flashcards-plur-03-learning-area-quiz"></div>
                    <div class="fca01-center-btn">
                        <button id="ex-flashcards-plur-03-start-quiz-btn" class="btn btn-primary hidden">–ù–æ–≤—ã–π –≤–æ–ø—Ä–æ—Å</button>
                    </div>
                </div>

                <div id="ex-flashcards-plur-03-section-match" class="fca01-section">
                    <div id="ex-flashcards-plur-03-learning-area-match"></div>
                    <div class="fca01-center-btn">
                        <button id="ex-flashcards-plur-03-reset-match-btn" class="btn btn-secondary">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
                    </div>
                </div>
            </section>

            <script type="text/plain" data-lazy-script="panel-acc-open-3">
(() => {
    const rootEl = document.getElementById('ex-flashcards-plur-03');
    if (!rootEl) {
        console.warn('‚ö†Ô∏è Flashcards: Container #ex-flashcards-plur-03 NOT FOUND');
        return;
    }

    function initFlashcardsPlur03(root) {
        const flashcardsData = [
            // TODO: Add flashcard data
            // { front: "...", back: "..." },
        ];

        let currentMode = 'study';
        let currentIndex = 0;
        let selectedMatchCard = null;
        let isProcessingMatch = false;
        let cachedRuVoice = null;

        function pickRuVoice() {
            const voices = window.speechSynthesis.getVoices();
            const ruVoice = voices.find(v => v.lang.includes('ru'));
            if (ruVoice) cachedRuVoice = ruVoice;
        }

        function textToSpeech(text, lang = 'ru-RU') {
            if (!('speechSynthesis' in window)) return;
            window.speechSynthesis.cancel();
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = lang;
            utterance.rate = 0.9;
            utterance.pitch = 1;
            utterance.volume = 1;
            if (cachedRuVoice) utterance.voice = cachedRuVoice;
            window.speechSynthesis.speak(utterance);
        }

        function playAudio(text, event) {
            event.stopPropagation();
            textToSpeech(text);
        }

        function switchMode(mode) {
            currentMode = mode;
            root.querySelectorAll('.fca01-mode-btn').forEach(btn => btn.classList.remove('active'));
            root.querySelectorAll('.fca01-section').forEach(sec => sec.classList.remove('visible'));
            root.querySelector(`#ex-flashcards-plur-03-section-${mode}`).classList.add('visible');
            root.querySelector(`[data-mode="${mode}"]`).classList.add('active');

            if (mode === 'study') { currentIndex = 0; renderCard(); }
            else if (mode === 'quiz') { renderQuiz(); root.querySelector('#ex-flashcards-plur-03-start-quiz-btn').classList.add('hidden'); }
            else if (mode === 'match') { initMatchGame(); }
        }

        function renderCard() {
            const area = root.querySelector('#ex-flashcards-plur-03-learning-area-study');
            const counter = root.querySelector('#ex-flashcards-plur-03-counter');
            const cardData = flashcardsData[currentIndex];

            counter.textContent = `${currentIndex + 1} / ${flashcardsData.length}`;
            area.innerHTML = `
                <div class="fca01-card-container">
                    <div class="fca01-card">
                        <div class="fca01-card-face fca01-card-front">
                            <button class="fca01-audio-btn" data-text="${cardData.front}">üîä</button>
                            ${cardData.front}
                        </div>
                        <div class="fca01-card-face fca01-card-back">
                            <button class="fca01-audio-btn" data-text="${cardData.back}">üîä</button>
                            ${cardData.back}
                        </div>
                    </div>
                </div>
            `;

            const card = area.querySelector('.fca01-card');
            card.addEventListener('click', function() {
                this.classList.toggle('is-flipped');
            });

            area.querySelectorAll('.fca01-audio-btn').forEach(btn => {
                btn.addEventListener('click', (e) => playAudio(btn.dataset.text, e));
            });
        }

        function nextCard() {
            currentIndex = (currentIndex + 1) % flashcardsData.length;
            renderCard();
        }

        function prevCard() {
            currentIndex = currentIndex > 0 ? currentIndex - 1 : flashcardsData.length - 1;
            renderCard();
        }

        function renderQuiz() {
            const area = root.querySelector('#ex-flashcards-plur-03-learning-area-quiz');
            root.querySelector('#ex-flashcards-plur-03-start-quiz-btn').classList.add('hidden');

            const randomIndex = Math.floor(Math.random() * flashcardsData.length);
            const correctCard = flashcardsData[randomIndex];

            let options = [correctCard];
            while (options.length < 3 && options.length < flashcardsData.length) {
                const randomWrong = flashcardsData[Math.floor(Math.random() * flashcardsData.length)];
                if (!options.some(opt => opt.back === randomWrong.back)) options.push(randomWrong);
            }
            options.sort(() => Math.random() - 0.5);

            const buttonsHTML = options.map(opt =>
                `<button class="fca01-quiz-option" data-answer="${opt.back}" data-correct="${correctCard.back}">
                    ${opt.back}
                </button>`
            ).join('');

            area.innerHTML = `
                <div class="fca01-quiz-area">
                    <h3 class="fca01-quiz-question">–ù–∞–π–¥–∏ –≤—Ç–æ—Ä—É—é —á–∞—Å—Ç—å: <br><span class="highlight">"${correctCard.front}"</span></h3>
                    <div class="fca01-quiz-options">${buttonsHTML}</div>
                    <p class="fca01-quiz-feedback"></p>
                </div>
            `;

            area.querySelectorAll('.fca01-quiz-option').forEach(btn => {
                btn.addEventListener('click', function() {
                    checkQuizAnswer(this.dataset.answer, this.dataset.correct, this);
                });
            });
        }

        function checkQuizAnswer(selected, correct, btnElement) {
            const feedback = root.querySelector('.fca01-quiz-feedback');
            const nextBtn = root.querySelector('#ex-flashcards-plur-03-start-quiz-btn');

            root.querySelectorAll('.fca01-quiz-option').forEach(btn => {
                btn.style.pointerEvents = 'none';
                if (btn.dataset.answer === correct) btn.classList.add('correct');
            });

            if (selected === correct) {
                feedback.textContent = "‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ!";
                feedback.className = "fca01-quiz-feedback correct";
            } else {
                btnElement.classList.add('wrong');
                feedback.textContent = "‚ùå –û—à–∏–±–∫–∞!";
                feedback.className = "fca01-quiz-feedback wrong";
            }
            nextBtn.classList.remove('hidden');
        }

        function initMatchGame() {
            const area = root.querySelector('#ex-flashcards-plur-03-learning-area-match');
            selectedMatchCard = null;
            isProcessingMatch = false;

            let fronts = flashcardsData.map((card, index) => ({ text: card.front, type: 'front', id: index }));
            let backs = flashcardsData.map((card, index) => ({ text: card.back, type: 'back', id: index }));

            fronts.sort(() => Math.random() - 0.5);
            backs.sort(() => Math.random() - 0.5);

            area.innerHTML = `
                <div class="fca01-match-container">
                    <p class="fca01-match-feedback"></p>
                    <div class="fca01-match-grid">
                        <div class="fca01-match-col" id="ex-flashcards-plur-03-match-col-fronts"></div>
                        <div class="fca01-match-col" id="ex-flashcards-plur-03-match-col-backs"></div>
                    </div>
                </div>
            `;

            const colFronts = root.querySelector('#ex-flashcards-plur-03-match-col-fronts');
            const colBacks = root.querySelector('#ex-flashcards-plur-03-match-col-backs');

            function createMatchElement(item) {
                const div = document.createElement('div');
                div.className = 'fca01-match-card';
                div.textContent = item.text;
                div.dataset.id = item.id;
                div.dataset.type = item.type;
                div.addEventListener('click', () => handleMatchClick(div));
                return div;
            }

            fronts.forEach(item => colFronts.appendChild(createMatchElement(item)));
            backs.forEach(item => colBacks.appendChild(createMatchElement(item)));
        }

        function handleMatchClick(clickedCard) {
            if (isProcessingMatch || clickedCard.classList.contains('matched')) return;
            if (clickedCard === selectedMatchCard) return;

            const feedbackEl = root.querySelector('.fca01-match-feedback');

            if (!selectedMatchCard) {
                selectedMatchCard = clickedCard;
                clickedCard.classList.add('selected');
                return;
            }

            if (selectedMatchCard.dataset.type === clickedCard.dataset.type) {
                selectedMatchCard.classList.remove('selected');
                selectedMatchCard = clickedCard;
                clickedCard.classList.add('selected');
                return;
            }

            const firstId = selectedMatchCard.dataset.id;
            const secondId = clickedCard.dataset.id;
            const previousCard = selectedMatchCard;

            if (firstId === secondId) {
                previousCard.classList.add('matched');
                clickedCard.classList.add('matched');
                feedbackEl.textContent = "‚ú® –û—Ç–ª–∏—á–Ω–æ!";
                feedbackEl.className = "fca01-match-feedback correct";
                selectedMatchCard = null;
                setTimeout(() => { feedbackEl.textContent = ""; }, 1000);

                const remaining = root.querySelectorAll('.fca01-match-card:not(.matched)').length;
                if (remaining === 0) feedbackEl.textContent = "üéâ –ü–û–ë–ï–î–ê! üéâ";
            } else {
                isProcessingMatch = true;
                clickedCard.classList.add('wrong');
                previousCard.classList.add('wrong');
                feedbackEl.textContent = "–ù–µ–≤–µ—Ä–Ω–æ";
                feedbackEl.className = "fca01-match-feedback wrong";

                setTimeout(() => {
                    clickedCard.classList.remove('selected', 'wrong');
                    previousCard.classList.remove('selected', 'wrong');
                    feedbackEl.textContent = "";
                    isProcessingMatch = false;
                }, 800);

                selectedMatchCard = null;
            }
        }

        pickRuVoice();
        if (!cachedRuVoice) {
            window.speechSynthesis.onvoiceschanged = () => {
                pickRuVoice();
                window.speechSynthesis.onvoiceschanged = null;
            };
        }

        root.querySelectorAll('.fca01-mode-btn').forEach(btn => {
            btn.addEventListener('click', () => switchMode(btn.dataset.mode));
        });

        root.querySelector('#ex-flashcards-plur-03-next-btn').addEventListener('click', nextCard);
        root.querySelector('#ex-flashcards-plur-03-prev-btn').addEventListener('click', prevCard);
        root.querySelector('#ex-flashcards-plur-03-start-quiz-btn').addEventListener('click', renderQuiz);
        root.querySelector('#ex-flashcards-plur-03-reset-match-btn').addEventListener('click', initMatchGame);

        switchMode('study');
    }

    initFlashcardsPlur03(rootEl);
})();
            </script>
        </div>

        <!-- ============================================================ -->
        <!-- Panel 9 -->
        <!-- ============================================================ -->
        <article class="exercise-card" data-status="open" data-target="panel-acc-open-9">
            <span class="exercise-type">FLASHCARDS</span>
            <h3 class="exercise-title"><!-- TODO: Title --></h3>
        </article>

        <div class="exercise-panel" id="panel-acc-open-9" data-access="student" hidden>
            <section id="ex-flashcards-plur-09">
                <div class="fca01-header">
                    <h2><!-- TODO: Header title --></h2>
                    <p>Scegliere modalit√†</p>
                </div>

                <div class="fca01-mode-buttons">
                    <button class="fca01-mode-btn active" data-mode="study">ESPLORARE</button>
                    <button class="fca01-mode-btn" data-mode="quiz">QUIZ</button>
                    <button class="fca01-mode-btn" data-mode="match">MATCH</button>
                </div>

                <div id="ex-flashcards-plur-09-section-study" class="fca01-section visible">
                    <div id="ex-flashcards-plur-09-learning-area-study"></div>
                    <div class="fca01-nav">
                        <button id="ex-flashcards-plur-09-prev-btn" class="fca01-btn-nav">‚Üê –ù–∞–∑–∞–¥</button>
                        <span id="ex-flashcards-plur-09-counter" class="fca01-counter">1 / 7</span>
                        <button id="ex-flashcards-plur-09-next-btn" class="btn btn-primary">–í–ø–µ—Ä–µ–¥ ‚Üí</button>
                    </div>
                </div>

                <div id="ex-flashcards-plur-09-section-quiz" class="fca01-section">
                    <div id="ex-flashcards-plur-09-learning-area-quiz"></div>
                    <div class="fca01-center-btn">
                        <button id="ex-flashcards-plur-09-start-quiz-btn" class="btn btn-primary hidden">–ù–æ–≤—ã–π –≤–æ–ø—Ä–æ—Å</button>
                    </div>
                </div>

                <div id="ex-flashcards-plur-09-section-match" class="fca01-section">
                    <div id="ex-flashcards-plur-09-learning-area-match"></div>
                    <div class="fca01-center-btn">
                        <button id="ex-flashcards-plur-09-reset-match-btn" class="btn btn-secondary">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
                    </div>
                </div>
            </section>

            <script type="text/plain" data-lazy-script="panel-acc-open-9">
(() => {
    const rootEl = document.getElementById('ex-flashcards-plur-09');
    if (!rootEl) {
        console.warn('‚ö†Ô∏è Flashcards: Container #ex-flashcards-plur-09 NOT FOUND');
        return;
    }

    function initFlashcardsPlur09(root) {
        const flashcardsData = [
            // TODO: Add flashcard data
            // { front: "...", back: "..." },
        ];

        let currentMode = 'study';
        let currentIndex = 0;
        let selectedMatchCard = null;
        let isProcessingMatch = false;
        let cachedRuVoice = null;

        function pickRuVoice() {
            const voices = window.speechSynthesis.getVoices();
            const ruVoice = voices.find(v => v.lang.includes('ru'));
            if (ruVoice) cachedRuVoice = ruVoice;
        }

        function textToSpeech(text, lang = 'ru-RU') {
            if (!('speechSynthesis' in window)) return;
            window.speechSynthesis.cancel();
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = lang;
            utterance.rate = 0.9;
            utterance.pitch = 1;
            utterance.volume = 1;
            if (cachedRuVoice) utterance.voice = cachedRuVoice;
            window.speechSynthesis.speak(utterance);
        }

        function playAudio(text, event) {
            event.stopPropagation();
            textToSpeech(text);
        }

        function switchMode(mode) {
            currentMode = mode;
            root.querySelectorAll('.fca01-mode-btn').forEach(btn => btn.classList.remove('active'));
            root.querySelectorAll('.fca01-section').forEach(sec => sec.classList.remove('visible'));
            root.querySelector(`#ex-flashcards-plur-09-section-${mode}`).classList.add('visible');
            root.querySelector(`[data-mode="${mode}"]`).classList.add('active');

            if (mode === 'study') { currentIndex = 0; renderCard(); }
            else if (mode === 'quiz') { renderQuiz(); root.querySelector('#ex-flashcards-plur-09-start-quiz-btn').classList.add('hidden'); }
            else if (mode === 'match') { initMatchGame(); }
        }

        function renderCard() {
            const area = root.querySelector('#ex-flashcards-plur-09-learning-area-study');
            const counter = root.querySelector('#ex-flashcards-plur-09-counter');
            const cardData = flashcardsData[currentIndex];

            counter.textContent = `${currentIndex + 1} / ${flashcardsData.length}`;
            area.innerHTML = `
                <div class="fca01-card-container">
                    <div class="fca01-card">
                        <div class="fca01-card-face fca01-card-front">
                            <button class="fca01-audio-btn" data-text="${cardData.front}">üîä</button>
                            ${cardData.front}
                        </div>
                        <div class="fca01-card-face fca01-card-back">
                            <button class="fca01-audio-btn" data-text="${cardData.back}">üîä</button>
                            ${cardData.back}
                        </div>
                    </div>
                </div>
            `;

            const card = area.querySelector('.fca01-card');
            card.addEventListener('click', function() {
                this.classList.toggle('is-flipped');
            });

            area.querySelectorAll('.fca01-audio-btn').forEach(btn => {
                btn.addEventListener('click', (e) => playAudio(btn.dataset.text, e));
            });
        }

        function nextCard() {
            currentIndex = (currentIndex + 1) % flashcardsData.length;
            renderCard();
        }

        function prevCard() {
            currentIndex = currentIndex > 0 ? currentIndex - 1 : flashcardsData.length - 1;
            renderCard();
        }

        function renderQuiz() {
            const area = root.querySelector('#ex-flashcards-plur-09-learning-area-quiz');
            root.querySelector('#ex-flashcards-plur-09-start-quiz-btn').classList.add('hidden');

            const randomIndex = Math.floor(Math.random() * flashcardsData.length);
            const correctCard = flashcardsData[randomIndex];

            let options = [correctCard];
            while (options.length < 3 && options.length < flashcardsData.length) {
                const randomWrong = flashcardsData[Math.floor(Math.random() * flashcardsData.length)];
                if (!options.some(opt => opt.back === randomWrong.back)) options.push(randomWrong);
            }
            options.sort(() => Math.random() - 0.5);

            const buttonsHTML = options.map(opt =>
                `<button class="fca01-quiz-option" data-answer="${opt.back}" data-correct="${correctCard.back}">
                    ${opt.back}
                </button>`
            ).join('');

            area.innerHTML = `
                <div class="fca01-quiz-area">
                    <h3 class="fca01-quiz-question">–ù–∞–π–¥–∏ –≤—Ç–æ—Ä—É—é —á–∞—Å—Ç—å: <br><span class="highlight">"${correctCard.front}"</span></h3>
                    <div class="fca01-quiz-options">${buttonsHTML}</div>
                    <p class="fca01-quiz-feedback"></p>
                </div>
            `;

            area.querySelectorAll('.fca01-quiz-option').forEach(btn => {
                btn.addEventListener('click', function() {
                    checkQuizAnswer(this.dataset.answer, this.dataset.correct, this);
                });
            });
        }

        function checkQuizAnswer(selected, correct, btnElement) {
            const feedback = root.querySelector('.fca01-quiz-feedback');
            const nextBtn = root.querySelector('#ex-flashcards-plur-09-start-quiz-btn');

            root.querySelectorAll('.fca01-quiz-option').forEach(btn => {
                btn.style.pointerEvents = 'none';
                if (btn.dataset.answer === correct) btn.classList.add('correct');
            });

            if (selected === correct) {
                feedback.textContent = "‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ!";
                feedback.className = "fca01-quiz-feedback correct";
            } else {
                btnElement.classList.add('wrong');
                feedback.textContent = "‚ùå –û—à–∏–±–∫–∞!";
                feedback.className = "fca01-quiz-feedback wrong";
            }
            nextBtn.classList.remove('hidden');
        }

        function initMatchGame() {
            const area = root.querySelector('#ex-flashcards-plur-09-learning-area-match');
            selectedMatchCard = null;
            isProcessingMatch = false;

            let fronts = flashcardsData.map((card, index) => ({ text: card.front, type: 'front', id: index }));
            let backs = flashcardsData.map((card, index) => ({ text: card.back, type: 'back', id: index }));

            fronts.sort(() => Math.random() - 0.5);
            backs.sort(() => Math.random() - 0.5);

            area.innerHTML = `
                <div class="fca01-match-container">
                    <p class="fca01-match-feedback"></p>
                    <div class="fca01-match-grid">
                        <div class="fca01-match-col" id="ex-flashcards-plur-09-match-col-fronts"></div>
                        <div class="fca01-match-col" id="ex-flashcards-plur-09-match-col-backs"></div>
                    </div>
                </div>
            `;

            const colFronts = root.querySelector('#ex-flashcards-plur-09-match-col-fronts');
            const colBacks = root.querySelector('#ex-flashcards-plur-09-match-col-backs');

            function createMatchElement(item) {
                const div = document.createElement('div');
                div.className = 'fca01-match-card';
                div.textContent = item.text;
                div.dataset.id = item.id;
                div.dataset.type = item.type;
                div.addEventListener('click', () => handleMatchClick(div));
                return div;
            }

            fronts.forEach(item => colFronts.appendChild(createMatchElement(item)));
            backs.forEach(item => colBacks.appendChild(createMatchElement(item)));
        }

        function handleMatchClick(clickedCard) {
            if (isProcessingMatch || clickedCard.classList.contains('matched')) return;
            if (clickedCard === selectedMatchCard) return;

            const feedbackEl = root.querySelector('.fca01-match-feedback');

            if (!selectedMatchCard) {
                selectedMatchCard = clickedCard;
                clickedCard.classList.add('selected');
                return;
            }

            if (selectedMatchCard.dataset.type === clickedCard.dataset.type) {
                selectedMatchCard.classList.remove('selected');
                selectedMatchCard = clickedCard;
                clickedCard.classList.add('selected');
                return;
            }

            const firstId = selectedMatchCard.dataset.id;
            const secondId = clickedCard.dataset.id;
            const previousCard = selectedMatchCard;

            if (firstId === secondId) {
                previousCard.classList.add('matched');
                clickedCard.classList.add('matched');
                feedbackEl.textContent = "‚ú® –û—Ç–ª–∏—á–Ω–æ!";
                feedbackEl.className = "fca01-match-feedback correct";
                selectedMatchCard = null;
                setTimeout(() => { feedbackEl.textContent = ""; }, 1000);

                const remaining = root.querySelectorAll('.fca01-match-card:not(.matched)').length;
                if (remaining === 0) feedbackEl.textContent = "üéâ –ü–û–ë–ï–î–ê! üéâ";
            } else {
                isProcessingMatch = true;
                clickedCard.classList.add('wrong');
                previousCard.classList.add('wrong');
                feedbackEl.textContent = "–ù–µ–≤–µ—Ä–Ω–æ";
                feedbackEl.className = "fca01-match-feedback wrong";

                setTimeout(() => {
                    clickedCard.classList.remove('selected', 'wrong');
                    previousCard.classList.remove('selected', 'wrong');
                    feedbackEl.textContent = "";
                    isProcessingMatch = false;
                }, 800);

                selectedMatchCard = null;
            }
        }

        pickRuVoice();
        if (!cachedRuVoice) {
            window.speechSynthesis.onvoiceschanged = () => {
                pickRuVoice();
                window.speechSynthesis.onvoiceschanged = null;
            };
        }

        root.querySelectorAll('.fca01-mode-btn').forEach(btn => {
            btn.addEventListener('click', () => switchMode(btn.dataset.mode));
        });

        root.querySelector('#ex-flashcards-plur-09-next-btn').addEventListener('click', nextCard);
        root.querySelector('#ex-flashcards-plur-09-prev-btn').addEventListener('click', prevCard);
        root.querySelector('#ex-flashcards-plur-09-start-quiz-btn').addEventListener('click', renderQuiz);
        root.querySelector('#ex-flashcards-plur-09-reset-match-btn').addEventListener('click', initMatchGame);

        switchMode('study');
    }

    initFlashcardsPlur09(rootEl);
})();
            </script>
        </div>

        <!-- ============================================================ -->
        <!-- Panel 10 -->
        <!-- ============================================================ -->
        <article class="exercise-card" data-status="open" data-target="panel-acc-open-10">
            <span class="exercise-type">FLASHCARDS</span>
            <h3 class="exercise-title"><!-- TODO: Title --></h3>
        </article>

        <div class="exercise-panel" id="panel-acc-open-10" data-access="paid" hidden>
            <section id="ex-flashcards-plur-10">
                <div class="fca01-header">
                    <h2><!-- TODO: Header title --></h2>
                    <p>Scegliere modalit√†</p>
                </div>

                <div class="fca01-mode-buttons">
                    <button class="fca01-mode-btn active" data-mode="study">ESPLORARE</button>
                    <button class="fca01-mode-btn" data-mode="quiz">QUIZ</button>
                    <button class="fca01-mode-btn" data-mode="match">MATCH</button>
                </div>

                <div id="ex-flashcards-plur-10-section-study" class="fca01-section visible">
                    <div id="ex-flashcards-plur-10-learning-area-study"></div>
                    <div class="fca01-nav">
                        <button id="ex-flashcards-plur-10-prev-btn" class="fca01-btn-nav">‚Üê –ù–∞–∑–∞–¥</button>
                        <span id="ex-flashcards-plur-10-counter" class="fca01-counter">1 / 7</span>
                        <button id="ex-flashcards-plur-10-next-btn" class="btn btn-primary">–í–ø–µ—Ä–µ–¥ ‚Üí</button>
                    </div>
                </div>

                <div id="ex-flashcards-plur-10-section-quiz" class="fca01-section">
                    <div id="ex-flashcards-plur-10-learning-area-quiz"></div>
                    <div class="fca01-center-btn">
                        <button id="ex-flashcards-plur-10-start-quiz-btn" class="btn btn-primary hidden">–ù–æ–≤—ã–π –≤–æ–ø—Ä–æ—Å</button>
                    </div>
                </div>

                <div id="ex-flashcards-plur-10-section-match" class="fca01-section">
                    <div id="ex-flashcards-plur-10-learning-area-match"></div>
                    <div class="fca01-center-btn">
                        <button id="ex-flashcards-plur-10-reset-match-btn" class="btn btn-secondary">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
                    </div>
                </div>
            </section>

            <script type="text/plain" data-lazy-script="panel-acc-open-10">
(() => {
    const rootEl = document.getElementById('ex-flashcards-plur-10');
    if (!rootEl) {
        console.warn('‚ö†Ô∏è Flashcards: Container #ex-flashcards-plur-10 NOT FOUND');
        return;
    }

    function initFlashcardsPlur10(root) {
        const flashcardsData = [
            // TODO: Add flashcard data
            // { front: "...", back: "..." },
        ];

        let currentMode = 'study';
        let currentIndex = 0;
        let selectedMatchCard = null;
        let isProcessingMatch = false;
        let cachedRuVoice = null;

        function pickRuVoice() {
            const voices = window.speechSynthesis.getVoices();
            const ruVoice = voices.find(v => v.lang.includes('ru'));
            if (ruVoice) cachedRuVoice = ruVoice;
        }

        function textToSpeech(text, lang = 'ru-RU') {
            if (!('speechSynthesis' in window)) return;
            window.speechSynthesis.cancel();
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = lang;
            utterance.rate = 0.9;
            utterance.pitch = 1;
            utterance.volume = 1;
            if (cachedRuVoice) utterance.voice = cachedRuVoice;
            window.speechSynthesis.speak(utterance);
        }

        function playAudio(text, event) {
            event.stopPropagation();
            textToSpeech(text);
        }

        function switchMode(mode) {
            currentMode = mode;
            root.querySelectorAll('.fca01-mode-btn').forEach(btn => btn.classList.remove('active'));
            root.querySelectorAll('.fca01-section').forEach(sec => sec.classList.remove('visible'));
            root.querySelector(`#ex-flashcards-plur-10-section-${mode}`).classList.add('visible');
            root.querySelector(`[data-mode="${mode}"]`).classList.add('active');

            if (mode === 'study') { currentIndex = 0; renderCard(); }
            else if (mode === 'quiz') { renderQuiz(); root.querySelector('#ex-flashcards-plur-10-start-quiz-btn').classList.add('hidden'); }
            else if (mode === 'match') { initMatchGame(); }
        }

        function renderCard() {
            const area = root.querySelector('#ex-flashcards-plur-10-learning-area-study');
            const counter = root.querySelector('#ex-flashcards-plur-10-counter');
            const cardData = flashcardsData[currentIndex];

            counter.textContent = `${currentIndex + 1} / ${flashcardsData.length}`;
            area.innerHTML = `
                <div class="fca01-card-container">
                    <div class="fca01-card">
                        <div class="fca01-card-face fca01-card-front">
                            <button class="fca01-audio-btn" data-text="${cardData.front}">üîä</button>
                            ${cardData.front}
                        </div>
                        <div class="fca01-card-face fca01-card-back">
                            <button class="fca01-audio-btn" data-text="${cardData.back}">üîä</button>
                            ${cardData.back}
                        </div>
                    </div>
                </div>
            `;

            const card = area.querySelector('.fca01-card');
            card.addEventListener('click', function() {
                this.classList.toggle('is-flipped');
            });

            area.querySelectorAll('.fca01-audio-btn').forEach(btn => {
                btn.addEventListener('click', (e) => playAudio(btn.dataset.text, e));
            });
        }

        function nextCard() {
            currentIndex = (currentIndex + 1) % flashcardsData.length;
            renderCard();
        }

        function prevCard() {
            currentIndex = currentIndex > 0 ? currentIndex - 1 : flashcardsData.length - 1;
            renderCard();
        }

        function renderQuiz() {
            const area = root.querySelector('#ex-flashcards-plur-10-learning-area-quiz');
            root.querySelector('#ex-flashcards-plur-10-start-quiz-btn').classList.add('hidden');

            const randomIndex = Math.floor(Math.random() * flashcardsData.length);
            const correctCard = flashcardsData[randomIndex];

            let options = [correctCard];
            while (options.length < 3 && options.length < flashcardsData.length) {
                const randomWrong = flashcardsData[Math.floor(Math.random() * flashcardsData.length)];
                if (!options.some(opt => opt.back === randomWrong.back)) options.push(randomWrong);
            }
            options.sort(() => Math.random() - 0.5);

            const buttonsHTML = options.map(opt =>
                `<button class="fca01-quiz-option" data-answer="${opt.back}" data-correct="${correctCard.back}">
                    ${opt.back}
                </button>`
            ).join('');

            area.innerHTML = `
                <div class="fca01-quiz-area">
                    <h3 class="fca01-quiz-question">–ù–∞–π–¥–∏ –≤—Ç–æ—Ä—É—é —á–∞—Å—Ç—å: <br><span class="highlight">"${correctCard.front}"</span></h3>
                    <div class="fca01-quiz-options">${buttonsHTML}</div>
                    <p class="fca01-quiz-feedback"></p>
                </div>
            `;

            area.querySelectorAll('.fca01-quiz-option').forEach(btn => {
                btn.addEventListener('click', function() {
                    checkQuizAnswer(this.dataset.answer, this.dataset.correct, this);
                });
            });
        }

        function checkQuizAnswer(selected, correct, btnElement) {
            const feedback = root.querySelector('.fca01-quiz-feedback');
            const nextBtn = root.querySelector('#ex-flashcards-plur-10-start-quiz-btn');

            root.querySelectorAll('.fca01-quiz-option').forEach(btn => {
                btn.style.pointerEvents = 'none';
                if (btn.dataset.answer === correct) btn.classList.add('correct');
            });

            if (selected === correct) {
                feedback.textContent = "‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ!";
                feedback.className = "fca01-quiz-feedback correct";
            } else {
                btnElement.classList.add('wrong');
                feedback.textContent = "‚ùå –û—à–∏–±–∫–∞!";
                feedback.className = "fca01-quiz-feedback wrong";
            }
            nextBtn.classList.remove('hidden');
        }

        function initMatchGame() {
            const area = root.querySelector('#ex-flashcards-plur-10-learning-area-match');
            selectedMatchCard = null;
            isProcessingMatch = false;

            let fronts = flashcardsData.map((card, index) => ({ text: card.front, type: 'front', id: index }));
            let backs = flashcardsData.map((card, index) => ({ text: card.back, type: 'back', id: index }));

            fronts.sort(() => Math.random() - 0.5);
            backs.sort(() => Math.random() - 0.5);

            area.innerHTML = `
                <div class="fca01-match-container">
                    <p class="fca01-match-feedback"></p>
                    <div class="fca01-match-grid">
                        <div class="fca01-match-col" id="ex-flashcards-plur-10-match-col-fronts"></div>
                        <div class="fca01-match-col" id="ex-flashcards-plur-10-match-col-backs"></div>
                    </div>
                </div>
            `;

            const colFronts = root.querySelector('#ex-flashcards-plur-10-match-col-fronts');
            const colBacks = root.querySelector('#ex-flashcards-plur-10-match-col-backs');

            function createMatchElement(item) {
                const div = document.createElement('div');
                div.className = 'fca01-match-card';
                div.textContent = item.text;
                div.dataset.id = item.id;
                div.dataset.type = item.type;
                div.addEventListener('click', () => handleMatchClick(div));
                return div;
            }

            fronts.forEach(item => colFronts.appendChild(createMatchElement(item)));
            backs.forEach(item => colBacks.appendChild(createMatchElement(item)));
        }

        function handleMatchClick(clickedCard) {
            if (isProcessingMatch || clickedCard.classList.contains('matched')) return;
            if (clickedCard === selectedMatchCard) return;

            const feedbackEl = root.querySelector('.fca01-match-feedback');

            if (!selectedMatchCard) {
                selectedMatchCard = clickedCard;
                clickedCard.classList.add('selected');
                return;
            }

            if (selectedMatchCard.dataset.type === clickedCard.dataset.type) {
                selectedMatchCard.classList.remove('selected');
                selectedMatchCard = clickedCard;
                clickedCard.classList.add('selected');
                return;
            }

            const firstId = selectedMatchCard.dataset.id;
            const secondId = clickedCard.dataset.id;
            const previousCard = selectedMatchCard;

            if (firstId === secondId) {
                previousCard.classList.add('matched');
                clickedCard.classList.add('matched');
                feedbackEl.textContent = "‚ú® –û—Ç–ª–∏—á–Ω–æ!";
                feedbackEl.className = "fca01-match-feedback correct";
                selectedMatchCard = null;
                setTimeout(() => { feedbackEl.textContent = ""; }, 1000);

                const remaining = root.querySelectorAll('.fca01-match-card:not(.matched)').length;
                if (remaining === 0) feedbackEl.textContent = "üéâ –ü–û–ë–ï–î–ê! üéâ";
            } else {
                isProcessingMatch = true;
                clickedCard.classList.add('wrong');
                previousCard.classList.add('wrong');
                feedbackEl.textContent = "–ù–µ–≤–µ—Ä–Ω–æ";
                feedbackEl.className = "fca01-match-feedback wrong";

                setTimeout(() => {
                    clickedCard.classList.remove('selected', 'wrong');
                    previousCard.classList.remove('selected', 'wrong');
                    feedbackEl.textContent = "";
                    isProcessingMatch = false;
                }, 800);

                selectedMatchCard = null;
            }
        }

        pickRuVoice();
        if (!cachedRuVoice) {
            window.speechSynthesis.onvoiceschanged = () => {
                pickRuVoice();
                window.speechSynthesis.onvoiceschanged = null;
            };
        }

        root.querySelectorAll('.fca01-mode-btn').forEach(btn => {
            btn.addEventListener('click', () => switchMode(btn.dataset.mode));
        });

        root.querySelector('#ex-flashcards-plur-10-next-btn').addEventListener('click', nextCard);
        root.querySelector('#ex-flashcards-plur-10-prev-btn').addEventListener('click', prevCard);
        root.querySelector('#ex-flashcards-plur-10-start-quiz-btn').addEventListener('click', renderQuiz);
        root.querySelector('#ex-flashcards-plur-10-reset-match-btn').addEventListener('click', initMatchGame);

        switchMode('study');
    }

    initFlashcardsPlur10(rootEl);
})();
            </script>
        </div>

<!-- ============================================================ -->
        <!-- Panel 11 -->
        <!-- ============================================================ -->
        <article class="exercise-card" data-status="open" data-target="panel-acc-open-11">
            <span class="exercise-type">FLASHCARDS</span>
            <h3 class="exercise-title"><!-- TODO: Title --></h3>
        </article>

        <div class="exercise-panel" id="panel-acc-open-11" data-access="public" hidden>
            <section id="ex-flashcards-plur-11">
                <div class="fca01-header">
                    <h2><!-- TODO: Header title --></h2>
                    <p>Scegliere modalit√†</p>
                </div>

                <div class="fca01-mode-buttons">
                    <button class="fca01-mode-btn active" data-mode="study">ESPLORARE</button>
                    <button class="fca01-mode-btn" data-mode="quiz">QUIZ</button>
                    <button class="fca01-mode-btn" data-mode="match">MATCH</button>
                </div>

                <div id="ex-flashcards-plur-11-section-study" class="fca01-section visible">
                    <div id="ex-flashcards-plur-11-learning-area-study"></div>
                    <div class="fca01-nav">
                        <button id="ex-flashcards-plur-11-prev-btn" class="fca01-btn-nav">‚Üê –ù–∞–∑–∞–¥</button>
                        <span id="ex-flashcards-plur-11-counter" class="fca01-counter">1 / 7</span>
                        <button id="ex-flashcards-plur-11-next-btn" class="btn btn-primary">–í–ø–µ—Ä–µ–¥ ‚Üí</button>
                    </div>
                </div>

                <div id="ex-flashcards-plur-11-section-quiz" class="fca01-section">
                    <div id="ex-flashcards-plur-11-learning-area-quiz"></div>
                    <div class="fca01-center-btn">
                        <button id="ex-flashcards-plur-11-start-quiz-btn" class="btn btn-primary hidden">–ù–æ–≤—ã–π –≤–æ–ø—Ä–æ—Å</button>
                    </div>
                </div>

                <div id="ex-flashcards-plur-11-section-match" class="fca01-section">
                    <div id="ex-flashcards-plur-11-learning-area-match"></div>
                    <div class="fca01-center-btn">
                        <button id="ex-flashcards-plur-11-reset-match-btn" class="btn btn-secondary">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
                    </div>
                </div>
            </section>

            <script type="text/plain" data-lazy-script="panel-acc-open-11">
(() => {
    const rootEl = document.getElementById('ex-flashcards-plur-02');
    if (!rootEl) {
        console.warn('‚ö†Ô∏è Flashcards: Container #ex-flashcards-plur-02 NOT FOUND');
        return;
    }

    function initFlashcardsPlur02(root) {
        const flashcardsData = [
            // TODO: Add flashcard data
            // { front: "...", back: "..." },
        ];

        let currentMode = 'study';
        let currentIndex = 0;
        let selectedMatchCard = null;
        let isProcessingMatch = false;
        let cachedRuVoice = null;

        function pickRuVoice() {
            const voices = window.speechSynthesis.getVoices();
            const ruVoice = voices.find(v => v.lang.includes('ru'));
            if (ruVoice) cachedRuVoice = ruVoice;
        }

        function textToSpeech(text, lang = 'ru-RU') {
            if (!('speechSynthesis' in window)) return;
            window.speechSynthesis.cancel();
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = lang;
            utterance.rate = 0.9;
            utterance.pitch = 1;
            utterance.volume = 1;
            if (cachedRuVoice) utterance.voice = cachedRuVoice;
            window.speechSynthesis.speak(utterance);
        }

        function playAudio(text, event) {
            event.stopPropagation();
            textToSpeech(text);
        }

        function switchMode(mode) {
            currentMode = mode;
            root.querySelectorAll('.fca01-mode-btn').forEach(btn => btn.classList.remove('active'));
            root.querySelectorAll('.fca01-section').forEach(sec => sec.classList.remove('visible'));
            root.querySelector(`#ex-flashcards-plur-02-section-${mode}`).classList.add('visible');
            root.querySelector(`[data-mode="${mode}"]`).classList.add('active');

            if (mode === 'study') { currentIndex = 0; renderCard(); }
            else if (mode === 'quiz') { renderQuiz(); root.querySelector('#ex-flashcards-plur-02-start-quiz-btn').classList.add('hidden'); }
            else if (mode === 'match') { initMatchGame(); }
        }

        function renderCard() {
            const area = root.querySelector('#ex-flashcards-plur-02-learning-area-study');
            const counter = root.querySelector('#ex-flashcards-plur-02-counter');
            const cardData = flashcardsData[currentIndex];

            counter.textContent = `${currentIndex + 1} / ${flashcardsData.length}`;
            area.innerHTML = `
                <div class="fca01-card-container">
                    <div class="fca01-card">
                        <div class="fca01-card-face fca01-card-front">
                            <button class="fca01-audio-btn" data-text="${cardData.front}">üîä</button>
                            ${cardData.front}
                        </div>
                        <div class="fca01-card-face fca01-card-back">
                            <button class="fca01-audio-btn" data-text="${cardData.back}">üîä</button>
                            ${cardData.back}
                        </div>
                    </div>
                </div>
            `;

            const card = area.querySelector('.fca01-card');
            card.addEventListener('click', function() {
                this.classList.toggle('is-flipped');
            });

            area.querySelectorAll('.fca01-audio-btn').forEach(btn => {
                btn.addEventListener('click', (e) => playAudio(btn.dataset.text, e));
            });
        }

        function nextCard() {
            currentIndex = (currentIndex + 1) % flashcardsData.length;
            renderCard();
        }

        function prevCard() {
            currentIndex = currentIndex > 0 ? currentIndex - 1 : flashcardsData.length - 1;
            renderCard();
        }

        function renderQuiz() {
            const area = root.querySelector('#ex-flashcards-plur-02-learning-area-quiz');
            root.querySelector('#ex-flashcards-plur-02-start-quiz-btn').classList.add('hidden');

            const randomIndex = Math.floor(Math.random() * flashcardsData.length);
            const correctCard = flashcardsData[randomIndex];

            let options = [correctCard];
            while (options.length < 3 && options.length < flashcardsData.length) {
                const randomWrong = flashcardsData[Math.floor(Math.random() * flashcardsData.length)];
                if (!options.some(opt => opt.back === randomWrong.back)) options.push(randomWrong);
            }
            options.sort(() => Math.random() - 0.5);

            const buttonsHTML = options.map(opt =>
                `<button class="fca01-quiz-option" data-answer="${opt.back}" data-correct="${correctCard.back}">
                    ${opt.back}
                </button>`
            ).join('');

            area.innerHTML = `
                <div class="fca01-quiz-area">
                    <h3 class="fca01-quiz-question">–ù–∞–π–¥–∏ –≤—Ç–æ—Ä—É—é —á–∞—Å—Ç—å: <br><span class="highlight">"${correctCard.front}"</span></h3>
                    <div class="fca01-quiz-options">${buttonsHTML}</div>
                    <p class="fca01-quiz-feedback"></p>
                </div>
            `;

            area.querySelectorAll('.fca01-quiz-option').forEach(btn => {
                btn.addEventListener('click', function() {
                    checkQuizAnswer(this.dataset.answer, this.dataset.correct, this);
                });
            });
        }

        function checkQuizAnswer(selected, correct, btnElement) {
            const feedback = root.querySelector('.fca01-quiz-feedback');
            const nextBtn = root.querySelector('#ex-flashcards-plur-02-start-quiz-btn');

            root.querySelectorAll('.fca01-quiz-option').forEach(btn => {
                btn.style.pointerEvents = 'none';
                if (btn.dataset.answer === correct) btn.classList.add('correct');
            });

            if (selected === correct) {
                feedback.textContent = "‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ!";
                feedback.className = "fca01-quiz-feedback correct";
            } else {
                btnElement.classList.add('wrong');
                feedback.textContent = "‚ùå –û—à–∏–±–∫–∞!";
                feedback.className = "fca01-quiz-feedback wrong";
            }
            nextBtn.classList.remove('hidden');
        }

        function initMatchGame() {
            const area = root.querySelector('#ex-flashcards-plur-02-learning-area-match');
            selectedMatchCard = null;
            isProcessingMatch = false;

            let fronts = flashcardsData.map((card, index) => ({ text: card.front, type: 'front', id: index }));
            let backs = flashcardsData.map((card, index) => ({ text: card.back, type: 'back', id: index }));

            fronts.sort(() => Math.random() - 0.5);
            backs.sort(() => Math.random() - 0.5);

            area.innerHTML = `
                <div class="fca01-match-container">
                    <p class="fca01-match-feedback"></p>
                    <div class="fca01-match-grid">
                        <div class="fca01-match-col" id="ex-flashcards-plur-02-match-col-fronts"></div>
                        <div class="fca01-match-col" id="ex-flashcards-plur-02-match-col-backs"></div>
                    </div>
                </div>
            `;

            const colFronts = root.querySelector('#ex-flashcards-plur-02-match-col-fronts');
            const colBacks = root.querySelector('#ex-flashcards-plur-02-match-col-backs');

            function createMatchElement(item) {
                const div = document.createElement('div');
                div.className = 'fca01-match-card';
                div.textContent = item.text;
                div.dataset.id = item.id;
                div.dataset.type = item.type;
                div.addEventListener('click', () => handleMatchClick(div));
                return div;
            }

            fronts.forEach(item => colFronts.appendChild(createMatchElement(item)));
            backs.forEach(item => colBacks.appendChild(createMatchElement(item)));
        }

        function handleMatchClick(clickedCard) {
            if (isProcessingMatch || clickedCard.classList.contains('matched')) return;
            if (clickedCard === selectedMatchCard) return;

            const feedbackEl = root.querySelector('.fca01-match-feedback');

            if (!selectedMatchCard) {
                selectedMatchCard = clickedCard;
                clickedCard.classList.add('selected');
                return;
            }

            if (selectedMatchCard.dataset.type === clickedCard.dataset.type) {
                selectedMatchCard.classList.remove('selected');
                selectedMatchCard = clickedCard;
                clickedCard.classList.add('selected');
                return;
            }

            const firstId = selectedMatchCard.dataset.id;
            const secondId = clickedCard.dataset.id;
            const previousCard = selectedMatchCard;

            if (firstId === secondId) {
                previousCard.classList.add('matched');
                clickedCard.classList.add('matched');
                feedbackEl.textContent = "‚ú® –û—Ç–ª–∏—á–Ω–æ!";
                feedbackEl.className = "fca01-match-feedback correct";
                selectedMatchCard = null;
                setTimeout(() => { feedbackEl.textContent = ""; }, 1000);

                const remaining = root.querySelectorAll('.fca01-match-card:not(.matched)').length;
                if (remaining === 0) feedbackEl.textContent = "üéâ –ü–û–ë–ï–î–ê! üéâ";
            } else {
                isProcessingMatch = true;
                clickedCard.classList.add('wrong');
                previousCard.classList.add('wrong');
                feedbackEl.textContent = "–ù–µ–≤–µ—Ä–Ω–æ";
                feedbackEl.className = "fca01-match-feedback wrong";

                setTimeout(() => {
                    clickedCard.classList.remove('selected', 'wrong');
                    previousCard.classList.remove('selected', 'wrong');
                    feedbackEl.textContent = "";
                    isProcessingMatch = false;
                }, 800);

                selectedMatchCard = null;
            }
        }

        pickRuVoice();
        if (!cachedRuVoice) {
            window.speechSynthesis.onvoiceschanged = () => {
                pickRuVoice();
                window.speechSynthesis.onvoiceschanged = null;
            };
        }

        root.querySelectorAll('.fca01-mode-btn').forEach(btn => {
            btn.addEventListener('click', () => switchMode(btn.dataset.mode));
        });

        root.querySelector('#ex-flashcards-plur-02-next-btn').addEventListener('click', nextCard);
        root.querySelector('#ex-flashcards-plur-02-prev-btn').addEventListener('click', prevCard);
        root.querySelector('#ex-flashcards-plur-02-start-quiz-btn').addEventListener('click', renderQuiz);
        root.querySelector('#ex-flashcards-plur-02-reset-match-btn').addEventListener('click', initMatchGame);

        switchMode('study');
    }

    initFlashcardsPlur02(rootEl);
})();
            </script>
        </div>

      
        <!-- Panel 4 -->
        <!-- ============================================================ -->
        <article class="exercise-card" data-status="open" data-target="panel-acc-open-4">
            <span class="exercise-type">QUIZ</span>
            <h3 class="exercise-title"><!-- TODO: Title --></h3>
        </article>

        <div class="exercise-panel" id="panel-acc-open-4" data-access="public" hidden>
            <h2 class="quiz-title"><!-- TODO: Quiz title --></h2>
            <p class="quiz-instruction"><!-- TODO: Quiz instruction --></p>
            <ol class="quiz-list" id="panel-acc-open-4-quiz-list"></ol>
            <script type="text/plain" data-lazy-script="panel-acc-open-4">
(() => {
    const panel = document.getElementById('panel-acc-open-4');
    if (!panel) return;
    const quizList = panel.querySelector('#panel-acc-open-4-quiz-list');

    if (!quizList) {
        requestAnimationFrame(() => {
            const panel2 = document.getElementById('panel-acc-open-4');
            const quizList2 = panel2 && panel2.querySelector('#panel-acc-open-4-quiz-list');
            if (!quizList2) return;
            initQuiz(panel2);
        });
        return;
    }

    initQuiz(panel);

    function initQuiz(panelEl) {
        const quizListEl = panelEl.querySelector('#panel-acc-open-4-quiz-list');

        const quizData = [
            // TODO: Add quiz data
            // {
            //     id: "plur-001",
            //     promptPrefix: "...",
            //     promptSuffix: "...",
            //     answers: ["..."]
            // },
        ];

        function normalizeInput(str) {
            return str.trim().replace(/\s+/g, ' ');
        }

        function renderQuiz() {
            quizListEl.innerHTML = '';

            quizData.forEach((item, index) => {
                const li = document.createElement('li');
                li.className = 'quiz-item';
                li.dataset.id = item.id;

                const promptDiv = document.createElement('div');
                promptDiv.className = 'quiz-prompt';
                promptDiv.innerHTML = `${item.promptPrefix}<input type="text" class="quiz-input" data-index="${index}">${item.promptSuffix}`;

                const controlsDiv = document.createElement('div');
                controlsDiv.className = 'quiz-controls';

                const checkBtn = document.createElement('button');
                checkBtn.className = 'btn btn-primary quiz-check-btn';
                checkBtn.textContent = '–ü—Ä–æ–≤–µ—Ä–∏—Ç—å';
                checkBtn.dataset.index = index;

                const feedbackDiv = document.createElement('div');
                feedbackDiv.className = 'quiz-feedback';
                feedbackDiv.dataset.index = index;

                controlsDiv.appendChild(checkBtn);

                li.appendChild(promptDiv);
                li.appendChild(controlsDiv);
                li.appendChild(feedbackDiv);

                quizListEl.appendChild(li);

                const input = li.querySelector('.quiz-input');

                checkBtn.addEventListener('click', () => {
                    checkAnswer(index, input, checkBtn, feedbackDiv, item.answers);
                });

                input.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' && !checkBtn.disabled) {
                        checkAnswer(index, input, checkBtn, feedbackDiv, item.answers);
                    }
                });
            });
        }

        function checkAnswer(index, input, button, feedback, correctAnswers) {
            const userAnswer = normalizeInput(input.value);

            const isCorrect = correctAnswers.some(ans => userAnswer === ans);

            if (isCorrect) {
                input.classList.remove('incorrect');
                input.classList.add('correct');
                input.disabled = true;
                button.disabled = true;
                feedback.textContent = '–ü—Ä–∞–≤–∏–ª—å–Ω–æ!';
                feedback.className = 'quiz-feedback correct';
            } else {
                input.classList.remove('correct');
                input.classList.add('incorrect');
                feedback.textContent = '–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.';
                feedback.className = 'quiz-feedback incorrect';
            }
        }

        renderQuiz();
    }
})();
            </script>
        </div>

    </main>

    <footer class="level-footer">
        <a href="/index.html" class="back-link">Torna alla home</a>
    </footer>
<script>
document.addEventListener('DOMContentLoaded', () => {
    // 1. –ù–∞—Ö–æ–¥–∏–º –≤—Å–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –∫–ª–∏–∫–Ω—É—Ç—å
    const triggers = document.querySelectorAll('.exercise-card');

    triggers.forEach(trigger => {
        trigger.addEventListener('click', () => {
            // 2. –ü–æ–ª—É—á–∞–µ–º ID –ø–∞–Ω–µ–ª–∏, –∫–æ—Ç–æ—Ä—É—é –Ω—É–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å
            const targetId = trigger.getAttribute('data-target');
            const targetPanel = document.getElementById(targetId);

            if (targetPanel) {
                // 3. –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º –≤–∏–¥–∏–º–æ—Å—Ç—å (–æ—Ç–∫—Ä—ã—Ç—å/–∑–∞–∫—Ä—ã—Ç—å)
                targetPanel.hidden = !targetPanel.hidden;

                // 4. –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ: 'open' –∏–ª–∏ 'closed'
                const panelState = targetPanel.hidden ? 'closed' : 'open';
                
                // 5. –ú–µ–Ω—è–µ–º —Å—Ç—Ä–µ–ª–æ—á–∫—É –≤ CSS
                trigger.setAttribute('data-status', panelState);

                // --- –¢–í–û–ô –ù–ê–ô–î–ï–ù–ù–´–ô –ö–û–î (–í–°–¢–ê–í–õ–ï–ù –°–Æ–î–ê) ---
                
                // –ï—Å–ª–∏ –ø–∞–Ω–µ–ª—å –æ—Ç–∫—Ä—ã–ª–∞—Å—å –ò –æ–Ω–∞ –µ—â–µ –Ω–µ –±—ã–ª–∞ –∑–∞–ø—É—â–µ–Ω–∞
                if (panelState === 'open' && !targetPanel.hasAttribute('data-initialized')) {
                    
                    // –ò—â–µ–º —Å–∫—Ä–∏–ø—Ç –≤–Ω—É—Ç—Ä–∏ –ø–∞–Ω–µ–ª–∏
                    const lazyScript = targetPanel.querySelector('[data-lazy-script]');
                    
                    if (lazyScript) {
                        // –ë–µ—Ä–µ–º —Ç–µ–∫—Å—Ç —Å–∫—Ä–∏–ø—Ç–∞
                        const scriptCode = lazyScript.textContent;
                        
                        // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π, "–∂–∏–≤–æ–π" —Å–∫—Ä–∏–ø—Ç
                        const execScript = document.createElement('script');
                        execScript.textContent = scriptCode;
                        
                        // –í—Å—Ç–∞–≤–ª—è–µ–º –µ–≥–æ –≤ –ø–∞–Ω–µ–ª—å (–æ–Ω —Å—Ä–∞–∑—É –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è)
                        targetPanel.appendChild(execScript);
                        
                        // –°—Ç–∞–≤–∏–º –º–µ—Ç–∫—É, —á—Ç–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ, —á—Ç–æ–±—ã –Ω–µ –≥—Ä—É–∑–∏—Ç—å –¥–≤–∞–∂–¥—ã
                        targetPanel.setAttribute('data-initialized', 'true');
                    }
                }
                // --- –ö–û–ù–ï–¶ –¢–í–û–ï–ì–û –ö–û–î–ê ---
            }
        });
    });
});
</script>
</body>
</html>
